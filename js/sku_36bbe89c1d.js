define("zenjs/backbone/quantity",["require","backbone"],function(t){var e=t("backbone"),i=function(){};return e.View.extend({template:_.template('<div class="quantity">            <button class="minus" type="button" <% if (data.readonly){ %> disabled <% } %> ></button>            <input type="text" class="txt" pattern="[0-9]*" value="<%= data.num %>" <% if (data.readonly){ %> readonly <% } %>/>            <button class="plus" type="button" <% if (data.readonly){ %> disabled <% } %>></button>            <div class="response-area response-area-minus"></div>            <div class="response-area response-area-plus"></div>        </div>'),initialize:function(){var t=function(t,e,i){var n;return e<i?(n=e,0!==e&&(this.disabled=!0)):n=t<i?i:t>e?e:t,n};return function(e){this.onNumChange=e.onNumChange||i,this.onOverLimit=e.onOverLimit||i,this.limitNum=parseInt(e.limitNum,10),this.minimalNum=parseInt(e.minimalNum,10),this.minimalNum=0==this.minimalNum?0:this.minimalNum||1,this.onBelowLeast=e.onBelowLeast||i,this.disabled=e.disabled,this.num=t.call(this,e.num,this.limitNum,this.minimalNum),this.readonly=e.readonly,this.num!=e.num&&this.onNumChange(this.num)}}(),events:{"click .response-area-minus":"onSubClicked","click .response-area-plus":"onAddClicked","blur .txt":"onTxtBlur","focus .txt":"onTxtFocus"},onSubClicked:function(t){this.changeNum(this.num-1)},onAddClicked:function(){this.changeNum(this.num+1)},onTxtBlur:function(t){var e=t.target.value;this.changeNum(isNaN(e)?0:e)},onTxtFocus:function(t){var e=t.target;"function"==typeof e.select&&e.select(),setTimeout(function(){"function"==typeof e.setSelectionRange&&e.setSelectionRange(0,9999)},1)},changeNum:function(t){this.readonly||this.disabled||(t<this.minimalNum&&(this.onBelowLeast(t,this.minimalNum),t=this.minimalNum),t>this.limitNum&&(this.onOverLimit(t,this.limitNum),t=this.limitNum),this.updateBtnStatus(t),this.updateNum(t))},updateBtnStatus:function(){var t=function(t){t.addClass("disabled"),t.attr("disabled","true")},e=function(t){t.removeClass("disabled"),t.removeAttr("disabled")};return function(i){if(this.readonly)return t(this.nMinus),void t(this.nPlus);i>this.minimalNum?e(this.nMinus):t(this.nMinus),i>=this.limitNum?t(this.nPlus):e(this.nPlus)}}(),updateNum:function(t){this.disabled||(this.num=+t,this.$("input").val(this.num),this.onNumChange(this.num))},refreshNum:function(){var t=parseInt(this.$("input").val(),10);this.num!==t&&(t>0?this.limitNum>0&&t>this.limitNum?this.num=this.limitNum:this.num=t:(this.num=this.minimalNum,this.updateNum(this.num)),this.changeNum(this.num))},setLimitNum:function(t){this.disabled||t<1||(this.limitNum=+t,this.limitNum<this.num&&this.changeNum(this.limitNum))},setMinimalNum:function(t){this.disabled||t<1||(this.minimalNum=+t,this.num<this.minimalNum&&this.changeNum(this.minimalNum))},validateNum:function(t){var e=parseInt(this.$("input").val(),10);return this.$("input").val(e),e>this.limitNum||0===this.limitNum?(this.onOverLimit(e,this.limitNum),!1):!(e<this.minimalNum)||(this.onBelowLeast(e,this.minimalNum),!1)},getNum:function(){return this.validateNum()?(this.refreshNum(),this.num):null},render:function(){return this.$el.html(this.template({data:{num:this.num,readonly:this.readonly}})),this.nMinus=this.$(".minus"),this.nPlus=this.$(".plus"),this.updateBtnStatus(this.num),this}})}),define("zenjs/uploader/compressImg",[],function(){function t(t,e){for(var i=t.split(",")[1],n=window.atob(i),o=new ArrayBuffer(n.length),s=new Uint8Array(o),r=0;r<n.length;r++)s[r]=n.charCodeAt(r);return new Blob([s],{type:e})}return function(e,i,n){var o=new Image,s="newImage";if(o.onerror=function(t){n(t)},o.onload=function(){try{i=i?i:{};var e=this.width||100,o=this.height||100,r=i.quality||.6,a=i.type||"image/jpeg";i.width&&i.height?(e=i.width,o=i.height):i.width&&!i.height?(o=parseInt(o*(i.width/e),10),e=i.width):i.height&&!i.width?(e=parseInt(e*(i.height/o),10),o=i.height):i.maxWidth?e>i.maxWidth&&(o=parseInt(o*(i.maxWidth/e),10),e=i.maxWidth):i.maxHeight?o>i.maxHeight&&(e=parseInt(e*(i.maxHeight/o),10),o=i.maxHeight):i.maxSide?o>=e&&o>i.maxSide?(e=parseInt(e*(i.maxSide/o),10),o=i.maxSide):e>o&&e>i.maxSide&&(o=parseInt(o*(i.maxSide/e),10),e=i.maxSide):i.ratio&&(e=parseInt(e*i.ratio,10),o=parseInt(o*i.ratio,10));var l=document.createElement("canvas");l.width=e,l.height=o;var c=l.getContext("2d");c.clearRect(0,0,e,o),c.drawImage(this,0,0,e,o);var u=t(l.toDataURL(a,r),a);u.name=s,n(null,u)}catch(t){n(t)}},"string"==typeof e)o.setAttribute("crossOrigin","anonymous"),o.src=e,s=e;else if("object"==typeof e&&e.toString().indexOf("File")>=0){var r=new FileReader;r.readAsDataURL(e),r.onload=function(t){o.src=t.target&&t.target.result,e.name&&(s=e.name)}}else n(new Error("Error image source context"))}}),define("zenjs/uploader/photo_uploader",["require","bower_components/ajax/ajax","../util/ua","./compressImg"],function(t){t("bower_components/ajax/ajax");var e=t("../util/ua"),i=t("./compressImg"),n=function(){},o=window._global,s=function(){if(navigator.userAgent.match(/(Android (1.0|1.1|1.5|1.6|2.0|2.1))|(Windows Phone (OS 7|8.0))|(XBLWP)|(ZuneWP)|(w(eb)?OSBrowser)|(webOS)|(Kindle\/(1.0|2.0|2.5|3.0))/))return!1;var t=document.createElement("input");return t.type="file",!t.disabled},r=function(){var t="youzanwsc"===o.platform&&o.platform_version<="3.0.0";return!(e.getIOSVersion()>=9&&t)};return Backbone.View.extend({initialize:function(t){this.nInput=this.$("input"),this.nUploader=this.$("button"),this.save_to_shop=t.save_to_shop||!1,this.onValidUpload=t.onValidUpload||function(){return!0},this.onStartReadFile=t.onStartReadFile||n,this.onFinishReadFile=t.onFinishReadFile||n,this.onBeforeUpload=t.onBeforeUpload||n,this.onUploadSuccess=t.onUploadSuccess||n,this.onUploadError=t.onUploadError||n,this.onGetToken=t.onGetToken},events:{"click input":"onInputClicked","change input":"onFileChanged"},render:function(t){s()||(this.nInput.attr("disabled","disabled"),this.nUploader.css("padding-left","10px").html("您的浏览器不支持图片上传").attr("disabled","disabled")),r()||this.nInput.on("click",function(t){t.preventDefault(),motify.log("暂不支持图片上传功能")})},onInputClicked:function(t){t.target.value=""},onFileChanged:function(t){var e=this,n=t.target.files;_.map(n,function(t,n,o){var s=function(i,n){if(i&&(n=t),n.size>5242880)return void motify.log("图片太大啦~");if(e.onValidUpload({file:n})){e.onStartReadFile({file:n});var o=new FileReader;o.onload=function(t){e.onFinishReadFile({src:t.target.result,file:n})},o.readAsDataURL(n),e.getUploadToken(n)}};if(t.size>3145728){motify.log("正在压缩处理图片，请稍后~");try{i(t,{maxSide:4e3},s)}catch(e){s(null,t)}}else s(null,t)})},getUploadToken:function(t){var e=this;if(this.uptoken)return void this.doUploadPhoto(t);var i=function(i){e.uptoken=i,e.doUploadPhoto(t)},n=function(){motify.log("上传图片失败，请重试")};if(this.onGetToken&&"function"==typeof this.onGetToken)return void this.onGetToken(i,n);var o=window._global.url.wap+"/materials/storage/pubImgUploadToken.json";"https:"===location.protocol&&(o=o.replace("http://","https://")),$._ajax({url:o,type:"post",dataType:"json",timeout:5e3,cache:!1,xhrFields:{withCredentials:!0},beforeSend:function(){},success:function(t){i(t.data.uptoken)},error:function(t,e,i){n()},complete:function(t,e){}})},doUploadPhoto:function(t){var e=this,i=new FormData;i.append("token",this.uptoken),i.append("file",t),this.save_to_shop===!1&&i.append("x:skip_save",1);var n=t.name.split("."),s="";n.length>1&&(s="."+n[n.length-1]),i.append("x:ext",s),$._ajax({url:"//up.qbox.me",type:"post",data:i,dataType:"json",processData:!1,contentType:!1,timeout:8e4,beforeSend:function(){e.onBeforeUpload({file:t}),e.nInput.data("uploaded","false"),e.trigger("data_change"),e.trigger("data_change:start")},success:function(i){var n=o.url.imgqn+"/"+i.data.attachment_file;e.onUploadSuccess({url:n,file:t,data:i.data}),e.nInput.data("value",n),e.nInput.data("uploaded","true"),e.trigger("data_change"),e.trigger("data_change:success",{url:n})},error:function(i,n,o){e.onUploadError({file:t}),"timeout"===n&&motify.log("网络环境不佳<br/>请稍后重试")},complete:function(t,e){}})}})}),define("text!wap/showcase/sku/templates/message.html",[],function(){return'<%\n    var PLACEHOLDER_MAP = {\n        id_no: \'输入18位身份证号码\',\n        text: \'输入文本\',\n        tel: \'输入数字\',\n        email: \'输入邮箱\',\n        date: \'点击选择日期\',\n        time: \'点击选择时间\'\n    };\n\n%>\n\n<% if(messages.length !== 0) {%>\n    <div class=\'sku-message\'>\n        <% for (var j = 0, len = messages.length; j < len; j++) { %>\n        <dl class="clearfix">\n            <dt class="pull-left">\n                <label for="ipt-<%=j %>"><% if (messages[j].required == \'1\') { %><sup class="required">*</sup><% } %><%=messages[j].name %>\n                </label>\n                <% if (messages[j].type === \'image\') { %>\n                    <br>\n                    <span class="img-tip">仅限一张</span>\n                 <% } %>\n            </dt>\n            <dd class="comment-wrapper clearfix">\n                <% if (messages[j].multiple == \'0\') { %>\n                    <% if (messages[j].type === \'image\') { %>\n                        <input data-valid-type="<%=messages[j].type %>"\n                            <% if (isKdtApp) { %>multiple="multiple"<% } %>\n                            <% if (messages[j].required == \'1\') { %>required<% } %>\n                            tabindex="<%=j + 1 %>" id="ipt-<%=j %>"\n                            name="message_<%=j %>"\n                            type="file"\n                            accept="image/*"\n                            class="js-message photo-input"\n                        >\n                        <button class="btn btn-white image-input-trigger"><span class="take-photo">拍照</span>或<span class="select-photo">选择照片</span></button>\n                        <div class=\'image-input-show hide\'>\n                            <img />\n                        </div>\n                    <% } else { %>\n                        <%\n                            var type = messages[j].type;\n                            if ((\'id_no\' === messages[j].type) || (\'tel\' == messages[j].type)) {\n                                type = \'text\';\n                            } else if (\'time\' === messages[j].type && messages[j].datetime > 0) {\n                                type = \'datetime-local\';\n                            }\n                        %>\n                        <input placeholder="<%= PLACEHOLDER_MAP[messages[j].type] || \'\' %>"\n                            data-valid-type="<%=messages[j].type %>"\n                            <% if (messages[j].required == \'1\') { %>required<% } %>\n                            tabindex="<%=j + 1 %>"\n                            id="ipt-<%=j %>"\n                            name="message_<%=j %>"\n                            type="<%= type %>"\n                            class="txt js-message font-size-14"\n                            <% if (\'id_no\' === messages[j].type && id_no.length > 0) { %>\n                                value="<%=id_no %>"\n                            <% } %>\n                        >\n                        <% if (messages[j].type === \'id_no\') { %>\n                            <span class="cancel-input js-cancel-input"></span>\n                        <% } %>\n                    <% } %>\n                <% } else { %>\n                    <textarea data-valid-type="<%=messages[j].type %>"\n                        placeholder="点击填写段落文本"\n                        <% if (messages[j].required == \'1\') { %>required<% } %>\n                        tabindex="<%=j + 1 %>"\n                        id="ipt-<%=j %>"\n                        name="message_<%=j %>"\n                        cols="32"\n                        rows="1"\n                        class="txta js-message font-size-14 js-texta"></textarea>\n                <% } %>\n            </dd>\n        </dl>\n        <% } %>\n    </div>\n<% } %>\n'}),window.Utils=window.Utils||{},$.extend(window.Utils,{validMobile:function(t){return t=""+t,/^((\+86)|(86))?(1)\d{10}$/.test(t)},validPhone:function(t){return t=""+t,/^0[0-9\-]{10,13}$/.test(t)},validNumber:function(t){return/^\d+$/.test(t)},validHKPhone:function(t){return/^((\+852)|(852))?(5|6|8|9)\d{7}$/.test(t+"")},validTWPhone:function(t){return/^((\+886)|(886)|(0))?9\d{2}-?\d{3}-?\d{3}$/.test(t+"")},validEmail:function(t){return/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(t)},validPostalCode:function(t){return t=""+t,/^\d{6}$/.test(t)}}),define("wap/components/util/valid",function(){}),define("wap/showcase/sku/views/message",["require","jquery","zenjs/uploader/photo_uploader","text!wap/showcase/sku/templates/message.html","zenjs/util/ua","wap/components/util/valid"],function(t){var e=t("jquery"),i=t("zenjs/uploader/photo_uploader"),n=t("text!wap/showcase/sku/templates/message.html"),o=t("zenjs/util/ua");t("wap/components/util/valid");var s=o.isIOS(),r="youzanwsc"===window._global.platform||"youzanwxd"===window._global.platform;return Backbone.View.extend({events:{'input [data-type="id_no"]':"showCancelIcon","click .js-cancel-input":"clearInput","focus .js-texta":"changeTextaHeight"},template:_.template(n),initialize:function(t){this.messages=this.options.messages||[]},render:function(){this.$el.html(this.template({messages:this.messages,id_no:"",isIOS:s,isKdtApp:r})),0===this.messages.length&&this.$el.hide();var t=this.$(".photo-input");return this.photoUploaders=[],t.each(_(function(t,n){var o=e(n).parent(),s=o.find("img"),r=o.find(".image-input-show"),a=o.find("button"),l=new i({el:o,onFinishReadFile:function(t){r.removeClass("hide"),s.attr("src",t.src)},onBeforeUpload:function(){a.html("正在上传...")},onUploadSuccess:function(t){motify.log("上传成功"),s.attr("src",t.url+"!100x100.jpg"),a.html('<span class="take-photo">重拍</span>或<span class="select-photo">重新选择照片</span>')},onUploadError:function(){a.html("重新上传"),motify.log("上传失败，请重新上传"),r.addClass("hide")}}).render();this.photoUploaders.push(l)}).bind(this)),s||this.$el.find("input[type=date], input[type=time]").on("mouseover mousedown mouseup select click dblclick touchstart touchmove touchend touchcancel",function(t){t.stopPropagation()}),this},validate:function(t){for(var i,n,o,s,r=this,a=this.messages,l=0,c=a.length;l<c;l++){if(i="message_"+l,n=e.trim(t[i]),o=a[l],_.isEmpty(n)){if("1"==o.required)return"image"==o.type?motify.log("请上传 "+o.name):motify.log("请填写 "+o.name),!1}else{if("image"==o.type&&("false"==(s=r.$el.find("#ipt-"+l).data("uploaded"))||!s))return motify.log("图片还在上传中，请稍等。。"),!1;if("tel"==o.type&&!/^\d+$/.test(n))return motify.log("请填写正确的数字格式留言"),!1;if("email"==o.type&&!Utils.validEmail(n))return motify.log("请填写正确的邮箱"),!1;if("id_no"==o.type&&!/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/.test(n))return motify.log("请填写正确的身份证号码"),!1}if(n.length>200)return motify.log(o.name+" 写的太多了<br/>不要超过200字"),!1}return!0},getData:function(){var t={};return this.$("dl .js-message").each(function(i,n){var o="";"file"==n.type?o=e(n).data("value"):"datetime-local"===n.type&&(o=n.value.replace(/T/g," ")),t[n.name]=o||n.value||""}),this.validate(t)?t:null},showCancelIcon:function(t){e(t.target).val()?this.$(".js-cancel-input").show():this.$(".js-cancel-input").hide()},clearInput:function(){this.$('[data-type="id_no"]').val(""),this.$(".js-cancel-input").hide()},changeTextaHeight:function(){this.$(".js-texta").addClass("focus-texta")}})}),define("zenjs/backbone/base_view",["require","backbone","../core/trigger_method"],function(t){var e=t("backbone"),i=t("../core/trigger_method");return e.View.extend({clean:function(){return this.stopListening(),this},triggerMethod:i})}),define("bower_components/zenlist/list",["require","exports","module","zenjs/backbone/base_view"],function(t,e,i){var n=function(){},o=t("zenjs/backbone/base_view");i.exports=o.extend({initialize:function(t){return this.options=t=t||{},this.items=[],this.itemView=t.itemView,this.itemOptions=t.itemOptions||{},this.collection=t.collection,this.onAfterListChange=t.onAfterListChange||n,this.onAfterListLoad=t.onAfterListLoad||n,this.onAfterListDisplay=t.onAfterListDisplay||n,this.onListEmpty=t.onListEmpty||t.onEmptyList||this._onListEmpty,this.onItemClick=t.onItemClick||n,this.onViewItemAdded=t.onViewItemAdded||n,this.displaySize=t.displaySize||-1,this.emptyHTML=t.emptyHTML||"",this.emptyText=t.emptyText||"列表为空",this},render:function(t){return this.displaySize=(t||{}).displaySize==-1?-1:this.displaySize,this.clean(),this._setupListeners(),this.addAll(),this.onAfterListDisplay({list:this.collection}),this},fetchRender:function(t){return this.collection.fetch({data:t,success:_(function(t,e){this.render(),this.onAfterListLoad(this.collection,e),this.onFetchSuccess&&this.onFetchSuccess()}).bind(this),error:_.bind(function(){this.onAfterListLoad(this.collection,response)},this)}),this},_setupListeners:function(){this.collection&&(this.stopListening(this.collection),this.listenTo(this.collection,"add",this.addItem,this),this.listenTo(this.collection,"reset sort",this.render,this),this.listenTo(this.collection,"remove",this.onItemRemoved,this))},addItemListeners:function(t){var e=this;this.listenTo(t,"all",function(){var e="item:"+arguments[0],i=_.toArray(arguments);i.splice(0,1),i.unshift(e,t),this.trigger.apply(this,i),"item:click"==e&&this.onItemClick()}),this.listenTo(t.model,"change",function(){e.onAfterListChange({list:this.collection})})},addAll:function(){0===this.collection.length?this.fetching||this.triggerMethod("list:empty"):this.collection.each(function(t){this.addItem(t)},this)},removeAll:function(){for(var t=this.items.length-1;t>=0;t--)this.removeView(this.items[t]);this.onAfterListChange({list:this.collection})},addItem:function(t,e,i){if(!(this.displaySize>=0&&this.items.length>=this.displaySize)){1==this.collection.length&&(this.listEl||this.$el).html("");var n=new this.itemView(_.extend({},this.options.itemOptions,{model:t,index:this.collection.indexOf(t)}));this.items.push(n),this.addItemListeners(n),n.render(),this.onViewItemAdded({list:this.items,viewItem:n,model:t});return 0===(i||{}).at?(this.listEl||this.$el).prepend(n.el):(this.listEl||this.$el).append(n.el),n}},removeItem:function(t){var e=this.getViewByModel(t);e&&this.removeView(e)},removeView:function(t){var e;this.stopListening(t),t&&(this.stopListening(t.model),t.remove(),e=this.items.indexOf(t),this.items.splice(e,1)),0===this.collection.length&&(this.fetching||this.triggerMethod("list:empty"))},onItemRemoved:function(t){this.onAfterListChange({list:this.collection,action:"remove",model:t}),this.removeItem(t)},getViewByModel:function(t){return _.find(this.items,function(e,i){return e.model===t})},dispatchEventToAllViews:function(t,e){for(var i=this.items.length-1;i>=0;i--)this.items[i].trigger(t,e)},remove:function(){o.prototype.remove.call(this,arguments),this.removeAll(),this.collection.reset(),delete this.collection},clean:function(){o.prototype.clean.call(this,arguments),this.removeAll(),(this.listEl||this.$el).html(""),this.stopListening(this.collection)},_onListEmpty:function(){this.$el.html(this.emptyHTML||(this.emptyText?'<p style="text-align:center;line-height:60px;">'+this.emptyText+"</p>":""))}})}),define("text!wap/showcase/sku/templates/skuList.html",[],function(){return'<dt class="model-title sku-sel-title">\n    <label><%= skuCollection.k %>：</label>\n</dt>\n<dd>\n    <ul class="model-list sku-sel-list"></ul>\n</dd>'}),define("wap/showcase/sku/views/sku_list",["bower_components/zenlist/list","text!wap/showcase/sku/templates/skuList.html"],function(t,e){var i=Backbone.View.extend({tagName:"li",className:"tag sku-tag pull-left ellipsis",template:_.template("<%= data.name %>"),initialize:function(t){this.onItemClick=t.onItemClick||function(){},this.listenTo(this,"active",this.onActive),this.listenTo(this,"enable",this.enableView),this.listenTo(this,"disable",this.disableView),this.listenTo(this,"sku:active:selected_id",this.doActiveSelectedSku)},events:{click:"onClick"},onClick:function(){if(this.$el.hasClass("unavailable"))return!1;this.toggle(),this.onItemClick({v_id:this.model.id})},onActive:function(t){t.v_id!==this.model.id&&this.deActive()},toggle:function(){this.$el.toggleClass("active"),this.isActived=!this.isActived},active:function(){this.$el.addClass("active"),this.isActived=!0},deActive:function(){this.isActived&&(this.$el.removeClass("active"),this.isActived=!1)},doActiveSelectedSku:function(t){parseInt(this.model.get("id"),10)==parseInt(t.value,10)&&this.isEnabled()&&this.onClick()},disableView:function(t){parseInt(this.model.get("id"),10)==parseInt(t.value,10)&&(this.$el.addClass("unavailable"),this.enabled=!1)},enableView:function(t){this.enabled||!t||"all"!==t.value&&parseInt(t.value,10)!==parseInt(this.model.get("id"),10)||(this.$el.removeClass("unavailable"),this.enabled=!0)},isEnabled:function(){return this.enabled},render:function(){return this.$el.html(this.template(_.extend({data:this.model.toJSON()},{}))),this.enabled=!0,this}});return Backbone.View.extend({tagName:"dl",className:"clearfix block-item sku-list-container",template:_.template(e),initialize:function(t){this.skuCollection=t.skuCollection,this.onSkuActived=t.onSkuActived||function(){}},onItemClick:function(t){this.skuListView.dispatchEventToAllViews("active",t),this.onSkuActived(this.getActivedSku())},getActivedSku:function(){var t=this.skuListView.items,e=_.find(t,_(function(t){return t.isActived}).bind(this));if(e){return{thumb:e.model.get("imgUrl"),k_id:this.skuCollection.k_id,k_s:this.skuCollection.k_s,v_id:e.model.id,name:e.model.get("name")}}return null},activeFirstSku:function(){if(this.skuListView.items)for(var t in this.skuListView.items){var e=this.skuListView.items[t];if(e.isEnabled())return void e.onClick()}},activeSku:function(t){this.skuListView.dispatchEventToAllViews("sku:active:selected_id",{value:t})},disableSkuItem:function(t){this.skuListView.dispatchEventToAllViews("disable",{value:t})},enableSkuItem:function(t){this.skuListView.dispatchEventToAllViews("enable",{value:t})},enalbeAllSkuItem:function(){this.skuListView.dispatchEventToAllViews("enable",{value:"all"})},render:function(e){return this.$el.html(this.template({skuCollection:this.skuCollection})),this.skuListView=new t({collection:this.skuCollection,el:this.$(".model-list"),itemView:i,itemOptions:{onItemClick:_(this.onItemClick).bind(this)}}).render(),this}})}),define("wap/showcase/sku/views/sku_brain",[],function(){return Backbone.View.extend({initialize:function(t){this.collection=t.collection,this.skuTrees=t.skuTrees,Backbone.SKUEventCenter.on("sku:active",_(this.onSkuActived).bind(this))},onSkuActived:function(t){var e=this,i=t.activedSkus,n=t.clickedSku,o=["s1","s2","s3"];_.each(o,_(function(t){if(_.find(this.skuTrees,function(e){return e.k_s==t})){var o=_.filter(i,function(e){return e.k_s!==t}),s=this.collection.filter(function(t){return _.every(o,function(e){return t.get(e.k_s)==e.v_id})}),r=_.groupBy(s,function(e){return e.get(t)});window._global.isHotel?e.trigger("sku-comb:hasstock",{v_id:n,k_s:t}):_.each(r,function(i,n){_.every(i,function(t){return 0==t.get("stock_num")})?e.trigger("sku-comb:nostock",{v_id:n,k_s:t}):e.trigger("sku-comb:hasstock",{v_id:n,k_s:t})})}}).bind(this))}})}),define("wap/showcase/sku/model",[],function(t,e){var i,n;return e=e||{},e.SkuModel=i=Backbone.Model,e.SkuCollection=Backbone.Collection.extend({model:i}),e.SkuStockModel=n=Backbone.Model,e.SkuStockCollection=Backbone.Collection.extend({model:n}),e}),define("wap/showcase/sku/views/sku_selector",["./sku_list","./sku_brain","../model"],function(t,e,i){var n=i.SkuStockCollection,o=i.SkuCollection;return Backbone.View.extend({initialize:function(t){var e=this;t=t||{},this.goods_info=t.goods_info||{},this.skuCollectionArray=[],this.sku=(t||{}).sku,this.skuStockCollection=new n(this.sku.list),e.sku.none_sku?this.selectedSkuComb={id:e.sku.collection_id,get:function(t){return"price"===t?e.sku.collection_price||e.sku.remain_price||"":"points_price"===t?e.sku.collection_points_price||"":void 0}}:_.each(this.sku.tree,_(function(t){var e=new o(t.v);e.count=t.count,e.k=t.k,e.k_id=t.k_id,e.k_s=t.k_s,this.skuCollectionArray.push(e)}).bind(this)),Backbone.SKUEventCenter.on("enable",_(this.enalbeAllSkuItem).bind(this)),Backbone.SKUEventCenter.on("sku:disable:skuItem",_(this.diableSkuItem).bind(this)),Backbone.SKUEventCenter.on("sku:enable:skuItem",_(this.enableSkuItem).bind(this))},events:{},onSkuActived:function(){var t=[];_.each(this.skuListViews,function(e){var i=e.getActivedSku();i&&t.push(i)}),this.selectedSkuComb=this.getSelectedSkuComb(t),this.selectedSkuThumb=this.getSelectedSkuThumb(t),Backbone.SKUEventCenter.trigger("sku:selected",{skuComb:this.selectedSkuComb,skuThumb:this.selectedSkuThumb}),Backbone.SKUEventCenter.trigger("sku:active",{activedSkus:t})},getSelectedSkuComb:function(t){this.activedSkus=t;var e={},i={},n=null;if(_.each(t,function(t){e[t.k_s]=t.v_id,i[t.k_s]=t.name}),t.length===_.size(this.skuListViews)){var o=[];n=this.skuStockCollection.find(function(t){for(var n in e){if(t.get(n)!=e[n])return o=[],!1;o.push(i[n])}return!0}),n&&n.set("sku_names",o)}return n},getSelectedSkuThumb:function(t){var e=(this.goods_info.picture||[])[0];return _.each(t,function(t){if(t.thumb)return e=t.thumb,!1}),e},diableSkuItem:function(t){this.skuListViews[t.k_s].disableSkuItem(t.v_id)},enableSkuItem:function(t){this.skuListViews[t.k_s].enableSkuItem(t.v_id)},enalbeAllSkuItem:function(t){!!this.skuListViews[t.k_s]&&this.skuListViews[t.k_s].enalbeAllSkuItem()},autoSelect:function(){this.skuListViews&&_.each(this.skuListViews,function(t){1===t.skuCollection.length&&t.activeFirstSku()})},doActiveSelectedSku:function(t){var e=this.skuStockCollection.find(function(e){return e.get("id")==t});e&&_.each(this.skuListViews,function(t){var i=t.skuCollection.k_s||"";t.activeSku(e.get(i))})},getSelectedSku:function(){var t=_.pluck(this.sku.tree,"k_id"),e=this.sku,i=[];return this.selectedSkuComb?{status:!0,sku:this.selectedSkuComb}:(_.each(this.activedSkus,function(e){t=_.without(t,""+e.k_id)}),_.each(t,function(t){i.push(_.find(e.tree,function(e){return e.k_id===t}).k)}),{status:!1,errMsg:i.join(" 和 ")})},render:function(i){return this.skuListViews={},_.each(this.skuCollectionArray,_(function(e){var i=new t({skuCollection:e,onSkuActived:_(this.onSkuActived).bind(this)});this.$el.append(i.render().el),this.skuListViews[e.k_s]=i}).bind(this)),this.skuBrain=new e({collection:this.skuStockCollection,skuTrees:this.skuCollectionArray}),this.listenTo(this.skuBrain,"sku-comb:nostock",_(this.diableSkuItem).bind(this)),this.listenTo(this.skuBrain,"sku-comb:hasstock",_(this.enableSkuItem).bind(this)),this.sku.none_sku||this.onSkuActived(),this},clear:function(){return this.stopListening(),Backbone.SKUEventCenter.off("enable"),this.remove(),null}})}),define("text!wap/showcase/sku/templates/stock.html",[],function(){return"剩余<%= data.stock %><%= data.is_hotel ? '间' : '件' %>\n"}),define("wap/showcase/sku/views/sku_stock",["text!wap/showcase/sku/templates/stock.html"],function(t){return Backbone.View.extend({template:_.template(t),initialize:function(t){this.hide_stock=t.hide_stock,this.is_hotel=t.is_hotel},events:{},onClick:function(t){},render:function(t){return this.stock=this.stock||t.stock,!this.hide_stock&&this.stock&&this.$el.html(this.template({data:{stock:this.stock,is_hotel:this.is_hotel}})),this},setNum:function(t){this.stock=t,this.render({})}})}),define("text!wap/showcase/sku/templates/title.html",[],function(){return"<% if (goods_info['picture'].length > 0){ %>\n    <div class=\"js-goods-thumb-container thumb\"><img class=\"js-goods-thumb goods-thumb\" src=\"<%=goods_info['picture'][0] %>\" alt=\"\"></div>\n<% } %>\n<div class=\"detail goods-base-info clearfix\">\n    <p class=\"title c-black ellipsis\"><%- goods_info['title'] %></p>\n    <div class=\"goods-price clearfix\">\n    <% if (isPoints) { %>\n        <div class=\"current-price c-black\">\n            <span class='price-name pull-left font-size-14 c-orange'>兑换价：</span><i class=\"js-points-price price font-size-16 vertical-middle c-orange\"><%= sku['points_price'] || points_goods['points_price'] %></i>\n        </div>\n    <% } else if(activity){ %>\n        <div class=\"current-price c-black activity-price\">\n            <span class='price-name pull-left font-size-14 c-orange'>¥</span><i class=\"js-goods-price price font-size-16 vertical-middle c-orange\"><%= activity['price'] %></i>\n            <% if(activity['price_title']) { %>\n                <span class=\"price-tag vertical-middle js-price-tag\"><%= activity['price_title'] %></span>\n            <% } %>\n        </div>\n        <div class=\"old-price line-through js-old-price-wrapper\">\n            原价：¥<span class=\"js-old-price\"><%=sku['old_price'] && sku['old_price'] != '0.00' && sku['old_price'] != 0.00 ? sku['old_price'] : goods_info['price'] %></span>\n        </div>\n    <% }else{ %>\n        <div class=\"current-price pull-left c-black\">\n            <span class='price-name pull-left font-size-14 c-orange'>¥</span><i class=\"js-goods-price price font-size-16 vertical-middle c-orange\"><%= sku['price'] && sku['price'] != '0.00' && sku['price'] != 0.00 ? sku['price'] : goods_info['price'] %></i>\n        </div>\n    <% } %>\n    <% if(goods_info['origin'] && goods_info['origin'] !== '淘价：'){ %>\n        <div class=\"original-price vertical-middle font-size-14 line-through\"><%- goods_info['origin'] %></div>\n    <% } %>\n    </div>\n</div>\n<div class=\"js-cancel sku-cancel\">\n    <div class=\"cancel-img\"></div>\n</div>\n"}),define("zenjs/util/tpl",["require","jquery"],function(t){var e=t("jquery"),i=function(){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"},e=["&","<",">",'"',"'"],i=new RegExp("["+e.join("")+"]","g");return function(e){return null==e?"":(""+e).replace(i,function(e){return t[e]})}}(),n={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},o={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"};return function(t,s,r){var a;r=e.extend({},n,r);var l=new RegExp([(r.escape||/(.)^/).source,(r.interpolate||/(.)^/).source,(r.evaluate||/(.)^/).source].join("|")+"|$","g"),c=0,u="__p+='";t.replace(l,function(e,i,n,s,r){return u+=t.slice(c,r).replace(/\\|'|\r|\n|\t|\u2028|\u2029/g,function(t){return"\\"+o[t]}),i&&(u+="'+\n((__t=("+i+"))==null?'':escapeFunc(__t))+\n'"),n&&(u+="'+\n((__t=("+n+"))==null?'':__t)+\n'"),s&&(u+="';\n"+s+"\n__p+='"),c=r+e.length,e}),u+="';\n",r.variable||(u="with(obj||{}){\n"+u+"}\n"),u="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+u+"return __p;\n";try{a=new Function(r.variable||"obj","escapeFunc",u)}catch(t){throw t.source=u,t}if(s)return a(s,i);var d=function(t){return a.call(this,t,i)};return d.source="function("+(r.variable||"obj")+"){\n"+u+"}",d}}),define("zenjs/swp/utils",["require"],function(t){"use strict";function e(){this.__events={}}var i=$.extend;return e.prototype={on:function(t,e){return this.__events[t]||(this.__events[t]=[]),this.__events[t].push(e),this},emit:function(t){
var e=this.__events[t],i=Array.prototype.slice.call(arguments,1),n=this;e&&e.forEach(function(t){t.apply(n,i)})},removeListener:function(t,e){if(void 0!=this.__events[t]){var i;e?(i=this.__events[t].indexOf(e))>0&&this.__events[t].splice(i,1):delete this.__events[t]}}},{extend:i,EventEmitter:e,requestAnimationFrame:window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||function(t,e){return window.setTimeout(t,1e3/60)},cancelAnimationFrame:window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msRequestAnimationFrame||function(t){clearTimeout(t)}}}),define("zenjs/swp/input",["require","./utils"],function(t){"use strict";function e(t,e){n.apply(this,arguments),this.isStarting=!1,this.startPt=null,this.endPt=null,this.isDeaf=!1,this.options=o({listenMoving:!1},e),this.host=$(t),this.onTouchStart=this.onTouchStart.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.bind(this.host)}var i=t("./utils"),n=i.EventEmitter,o=i.extend;return e.prototype=Object.create(new n),o(e.prototype,{bind:function(t){var e=$(window);t.on("touchstart mousedown",this.onTouchStart),this.options.listenMoving&&e.on("touchmove mousemove",this.onTouchMove),e.on("touchend mouseup touchcancel",this.onTouchEnd)},onTouchStart:function(t){this.isDeaf||this.isStarting||(this.isStarting=!0,this.orgDirection=null,this.startPt=this.pointerEventToXY(t))},onTouchMove:function(t){this.isStarting&&this.caculate(t)},onTouchEnd:function(t){this.isStarting&&(this.isStarting=!1,this.caculate(t,!0))},caculate:function(t,e){var i,n;this.endPt=this.pointerEventToXY(t),i=this.startPt.y-this.endPt.y,n=this.startPt.x-this.endPt.x,0!=i&&this.emit(i>0?"up":"down",i,e,t),0!=n&&this.emit(n>0?"left":"right",n,e,t),null==this.orgDirection&&(this.orgDirection=Math.abs(n)>Math.abs(i)),this.emit("move",{x:n,y:i},e,t,{orgDirection:this.orgDirection})},pointerEventToXY:function(t){var e={x:0,y:0},i=t.type;if(t.originalEvent&&(t=t.originalEvent),"touchstart"==i||"touchmove"==i||"touchend"==i||"touchcancel"==i){var n=t.touches[0]||t.changedTouches[0];e.x=n.pageX,e.y=n.pageY}else"mousedown"!=i&&"mouseup"!=i&&"mousemove"!=i&&"mouseover"!=i&&"mouseout"!=i&&"mouseenter"!=i&&"mouseleave"!=i||(e.x=t.pageX,e.y=t.pageY);return e},deaf:function(){this.isDeaf=!0},undeaf:function(){this.isDeaf=!1},destroy:function(){var t=$(window);this.host.off("touchstart mousedown",this.onTouchStart),this.options.listenMoving&&t.off("touchmove mousemove",this.onTouchMove),t.off("touchend mouseup touchcancel",this.onTouchEnd)}}),e}),define("zenjs/swp/scroll",["require","./utils"],function(t){"use strict";function e(t,e){n.apply(this,arguments),this.wrapElem=t,this.wrapSize={width:t.width(),height:t.height()},this.options=o({loop:!0,autoPlay:!1,startIndex:0,disableTranslate3d:!1},e),this.init.apply(this,arguments)}var i=t("./utils"),n=i.EventEmitter,o=i.extend;return e.prototype=Object.create(new n),o(e.prototype,{init:function(){var t;this.wrapElem;this.pages=this.wrapElem.find(".swp-page"),t={position:"absolute",top:0,left:0,width:"100%",height:"100%",display:"block","-webkit-transform":this.getTranslateValue(-9999,0)},this.pages.css(t),this.mCache={dist:0,offsetPage:0},this.setCurrentPage(0),this.movePage(this.options.startIndex*this.wrapSize.width,!0)},getTranslateValue:function(t,e){return this.options.disableTranslate3d?"translate("+t+"px, "+e+"px)":"translate3d("+t+"px, "+e+"px, 0px)"},getCurrentDist:function(){return this.mCache.currentDist},renderPage:function(t,e){void 0==t&&(t=0),void 0==e&&(e=0);var i,n,o,s=this.wrapSize.width,r=e*s-t,a=r-s,l=r+s;i=this.getCurrentPage(),i.length&&(i[0].style["-webkit-transform"]=this.getTranslateValue(r,0),$(i[0]).addClass("page-in-view")),n=this.pages[this.mapLoopPage(e-1)],n&&(Math.abs(a)<=s?n.style["-webkit-transform"]=this.getTranslateValue(a,0):this.pages.length>2&&(n.style["-webkit-transform"]=this.getTranslateValue(-9999,0)),$(n).removeClass("page-in-view")),(o=this.pages[this.mapLoopPage(e+1)])&&(Math.abs(l)<=s?o.style["-webkit-transform"]=this.getTranslateValue(l,0):this.pages.length>2&&(o.style["-webkit-transform"]=this.getTranslateValue(-9999,0)),$(o).removeClass("page-in-view"))},movePage:function(t,e){var i;this.mCache.currentDist=t+this.mCache.dist,e&&(this.mCache.dist+=t),i=Math.round(this.mCache.currentDist/this.wrapSize.width),i!=this.mCache.offsetPage&&(this.setCurrentPage(i),this.emit("pageChangeEnd",this.getCurrentPage(),this.currentIndex,this.mCache.offsetPage),this.mCache.offsetPage=i),this.renderPage(this.mCache.currentDist,i)},getCurrentPage:function(){return this.pages.eq(this.currentIndex)},mapLoopPage:function(t){if(this.options.loop){var e=t<0?-1:1,i=this.pages.length;return Math.abs(i+e*Math.abs(t)%i)%i}return t>=this.pages.length||t<0?this.pages.length:t},setCurrentPage:function(t){this.currentIndex=this.mapLoopPage(t)}}),e}),define("zenjs/swp/spring_dummy",["require","./utils"],function(t){"use strict";function e(t,e,o){var s=t.wrapElem,r=this;n.apply(this,arguments),this.scroll=t,this.input=e,this.input.on("move",this.movementReact.bind(this)),this.wrapSize={width:s.width(),height:s.height()},this.options=i.extend({intervalTween:3e3,threshold:20},o),this.scroll.options.autoPlay&&this.initMove(),this.on("bounceEnd",function(){r.scroll.options.autoPlay&&r.initMove(),r.input.undeaf()}).on("bounceStart",function(){r.input.deaf()})}var i=t("./utils"),n=i.EventEmitter,o=i.requestAnimationFrame,s=i.cancelAnimationFrame,r=i.extend;return e.prototype=Object.create(new n),r(e.prototype,{clearTransition:function(){s(this.transitionReq)},movementReact:function(t,e,i,n){this.clearMove(),e&&this.launch(n.orgDirection?t.x:0)},launch:function(t){var e=this,i=t/Math.abs(t),n=0,o=e.wrapSize.width,s=Math.round(t/o),r=this.scroll.mCache.offsetPage;n=o*s,0==n&&Math.abs(t)>e.options.threshold&&(n=o*i),e.scroll.options.loop||(r<=0&&(n=Math.abs(t)>e.options.threshold&&i>0?o*i:o*(s-r)),1==this.scroll.pages.length?n=0:r>=this.scroll.pages.length-1&&(n=Math.abs(t)>e.options.threshold&&i<0?o*i:o*(s-r+this.scroll.pages.length-1))),this.initTween(n-t,150,"bounce")},initTween:function(t,e,i){function n(){if((s=new Date-a)>e)return r.emit(i,{x:t},!0),void r.emit(i+"End");r.emit(i,{x:t/e*s},!1),r.tweenRid=o(n)}if(0==t)return void this.emit(i+"End");var s,r=this,a=new Date;this.cancelTween(),this.emit(i+"Start"),n()},cancelTween:function(){s(this.tweenRid)},initMove:function(){function t(){i.currentIndex!=i.pages.length-1||i.options.loop?e.initTween(e.wrapSize.width,200,"autoPlay"):e.initTween(-e.wrapSize.width*(i.pages.length-1),200,"autoPlay"),e.moveTid=setTimeout(t,n)}var e=this,i=this.scroll,n=e.options.intervalTween;this.clearMove(),e.moveTid=setTimeout(t,n)},clearMove:function(){clearTimeout(this.moveTid)}}),e}),define("zenjs/swp/swp",["require","./input","./utils","./scroll","./spring_dummy"],function(t){"use strict";function e(t,e){this.wrapElem=t,this.options=e||{}}var i=t("./input"),n=t("./utils"),o=t("./scroll"),s=n.EventEmitter,r=n.extend,a=t("./spring_dummy");return e.prototype=Object.create(new s),r(e.prototype,{init:function(){if(!this.wrapElem.data("swp-init")){this.wrapElem.data("swp-init",!0);var t,e=this;$(window).on("dragstart",function(t){$(e.wrapElem).has(t.target).length>0&&t.preventDefault()}),this.input=new i(this.wrapElem,{listenMoving:!0}),t=this.scroll=new o(this.wrapElem,this.options),this.input.on("move",function(e,i,n,o){o.orgDirection&&(n.preventDefault(),t.movePage(e.x,i))}),this.dummy=new a(this.scroll,this.input,this.options),this.dummy.on("bounce",function(e,i){t.movePage(e.x,i)}).on("autoPlay",function(e,i){t.movePage(e.x,i)}),t.on("pageChangeEnd",function(t,e,i){this.emit("pageChangeEnd",t,e,i)}.bind(this)),this.initThumbnail()}},initThumbnail:function(){var t=this.options.thumbnailWrap;if(void 0!=t&&!(this.scroll.pages.length<=1)){t.empty();var e=$('<ul class="swp-thumbnail-list">');this.scroll.pages.each(function(){e.append('<li class="swiper-pagination-switch">')}),t.append(e),this.scroll.on("pageChangeEnd",function(t,i,n){var o;e.children().each(function(){o=$(this),o.toggleClass("swiper-active-switch",o.index()==i)})}),e.children().eq(this.scroll.currentIndex).addClass("swiper-active-switch")}},destroy:function(){this.input.destroy()}}),e}),define("text!zenjs/swp/templates/preview.html",[],function(){return'<style>\n    .swp-preview {\n        position: fixed;\n        top: 0;\n        left: 0;\n        right: 0;\n        bottom: 0;\n        z-index: 5000;\n        background-color: rgba(0,0,0,.95)\n    }\n    .swp-preview-page-wrap {\n        position: absolute;\n        left: 10px;\n        right: 10px;\n        top: 0;\n        bottom: 0;\n    }\n    .swp .swp-page.swp-preview-page img {\n        position: absolute;\n        top: 50%;\n        left: 50%;\n        width: 100%;\n        transform: translate3d(-50%, -50%, 0);\n        -webkit-transform: translate3d(-50%, -50%, 0);\n    }\n</style>\n\n<ul class="swp js-swp-wrap">\n    <% imgObjs.forEach(function(item){%>\n    <li class="swp-page swp-preview-page">\n        <div class="swp-preview-page-wrap">\n            <img class="swp-img" src="<%= item.src %>">\n        </div>\n    </li>\n    <% }) %>\n</ul>'}),define("zenjs/swp/preview",["require","../util/tpl","./swp","text!./templates/preview.html","./input"],function(t){"use strict";function e(t){this.rootElem=t}var i=t("../util/tpl"),n=t("./swp"),o=i(t("text!./templates/preview.html")),s=t("./input"),r=s.prototype.pointerEventToXY,a=$('<div class="swp-preview">');return function(){var t;a.on("mousedown touchstart",function(e){t=r(e)}).on("mouseup touchend",function(e){e.preventDefault();var i=r(e);Math.abs(i.x-t.x)+Math.abs(i.y-t.y)<10&&setTimeout(function(){a.remove()},200)})}(),e.prototype={init:function(){if(!this.rootElem.data("swp-preview-init")){this.rootElem.data("swp-preview-init",!0);var t=this;this.imgObjs=[],this.rootElem.on("click",function(e){var i,n=t.extractSrcFromElement($(e.target));t.imgObjs=t.extractSrc(),t.imgObjs.some(function(t,e){if(t.src==n)return i=e,!0}),void 0!=i&&t.pop(i)})}},pop:function(t){a.empty().appendTo($("body")),this.initSwp(t)},initSwp:function(t){a.html(o({imgObjs:this.imgObjs})),this.swp&&this.swp.destroy(),this.swp=new n(a.find(".js-swp-wrap"),{loop:!1,autoPlay:!1,startIndex:t}),this.swp.init()},extractSrc:function(){var t=this;return Array.prototype.slice.apply(this.rootElem.find("img, .swp-preview-item")).map(function(e){return{src:t.extractSrcFromElement($(e))}}).concat({src:this.extractSrcFromElement(this.rootElem)}).filter(function(t){return t.src})},extractSrcFromElement:function(t){return t.data("preview-src")||t.attr("src")||t.data("src")}},e}),define("bower_components/imagePreview/check_host",["require"],function(t){return function(t){for(var e=["imgqn.koudaitong.com","kdt-img.koudaitong.com","img.yzcdn.cn","dn-kdt-img.qbox.me"],i=!1,n=0,o=e.length;n<o;n++)if(t.indexOf(e[n])>-1){i=!0;break}return i}}),define("bower_components/imagePreview/views/preview",["zenjs/swp/preview","../check_host"],function(t,e){return t.prototype=$.extend(t.prototype,{extractSrcFromElement:function(t){var i=t.attr("src")||t.data("src")||"";return e(i)?i.replace(/!.*?\.jpg/i,"!640x320.jpg").replace(/\?imageView2\/.*/i,"!640x320.jpg"):i}}),t}),define("bower_components/imagePreview/views/wx_preview",["../check_host"],function(t){function e(e){var i=e.attr("data-src")||e.attr("src");if(!t(i))return i;var n=i.replace(/!.*?\.jpg/i,"!640x320.jpg").replace(/\?imageView2\/.*/i,"!640x320.jpg");return 0===n.indexOf("//")&&(n=window.location.protocol+n),n}function i(t){var e,i=t.closest("a");return!!(i.length&&(e=i.attr("href"))&&/^(http|tel|mailto|#)/i.test(e))}function n(){var t=e($(this));s(t,[t])}var o=[],s=function(t,e){window.WeixinJSBridge&&window.WeixinJSBridge.invoke("imagePreview",{current:t,urls:e})},r={init:function(t){t=t?t:".js-view-image-list";var r=$(t);if(!r.data("swp-preview-init")){r.data("swp-preview-init",!0);$(".js-view-image").each(function(){var t=$(this),n=e(t);i(t)||t.width()>=0&&n&&(o.push(n),t.on("click",function(){s(n,o)}))}),r.each(function(t){var n=$(this);n.on("click","img",function(t){var o=n.find(".js-view-image-item");if(0===o.length&&(o=n.find("img")),!i($(t.target))){o=o.map(function(){return e($(this))}).toArray();var r=e($(this));o.indexOf(r)<0&&(o=[r]),s(r,o)}})}),$(document.body).off("click",".js-view-single-image",n).on("click",".js-view-single-image",n)}},clear:function(){o=[]}};return window.imagePreview=r,r}),define("bower_components/imagePreview/main",["zenjs/util/ua","./views/preview","./views/wx_preview"],function(t,e,i){function n(t){var e,i;for(i=0;i<2;i++)if(t=t.parent(),(e=t.attr("href"))&&/^(http|tel|mailto|#)/i.test(e))return!0;return!1}function o(e){var i=[];if(t.isAndroid()){var n=e.find("img")||[];"img"===e.prop("tagName").toLowerCase()&&n.push(e[0]),i=n.filter(function(t){var e=$(n[t]);return(e.attr("data-src")||e.attr("src")||"").indexOf("data:image/")>-1})}return t.isWeixin()&&window.top===window&&0===i.length}return function(t){$(t).each(function(){var t=$(this);if(t.data("force_show"))t.click(function(t){t.preventDefault(),t.stopPropagation()});else if(n(t))return;o(t)?i.init(t):new e(t).init()})}}),define("wap/showcase/sku/views/sku_title",["text!wap/showcase/sku/templates/title.html","bower_components/imagePreview/main"],function(t,e){return Backbone.View.extend({initialize:function(t){this.difTitle=(t||{}).difTitle},template:_.template(t),changeSkuThumb:function(t){this.skuThumb=t,this.$(".js-goods-thumb").attr("src",this.skuThumb)},changePrice:function(t){this.price=t,this.$(".js-goods-price").html((t/100).toFixed(2))},changeOldPrice:function(t,e){this.old_price=t;var i=this.$(".js-old-price-wrapper");e?i.hide():i.show(),this.$(".js-old-price").html((t/100).toFixed(2))},changePointsPrice:function(t){this.points_price=t.points_price,this.remain_price=(t.remain_price/100).toFixed(2),this.$(".js-points-price").html(this.points_price+"积分+¥"+this.remain_price)},changePriceTitle:function(t){t=t||"",t?this.$(".js-price-tag").show():this.$(".js-price-tag").hide(),this.$(".js-price-tag").html(t)},getPrice:function(){return this.price},getPointsPrice:function(){return this.points_price},resetPrice:function(){this.$(".js-goods-price").html(this.priceScope),this.$(".js-points-price").html(this.pointsPriceScope),this.$(".js-old-price").html(this.oldPriceScope).parent(".js-old-price-wrapper").show()},resetPriceTitle:function(){this.originPriceTitle?this.$(".js-price-tag").show():this.$(".js-price-tag").hide(),this.$(".js-price-tag").html(this.originPriceTitle)},render:function(t){var i=t.activity||{};return this.$el.html(this.template(t)),this.priceScope=this.$el.find(".js-goods-price").text(),this.pointsPriceScope=this.$el.find(".js-points-price").text(),this.oldPriceScope=this.$el.find(".js-old-price").text(),this.isPoints=t.isPoints,this.originPriceTitle=i.price_title||"",e($(".js-goods-thumb-container")),this}})}),define("bower_components/aes/aes",["require","exports","module"],function(t,e,i){var n=n||function(t,e){var i={},n=i.lib={},o=function(){},s=n.Base={extend:function(t){o.prototype=this;var e=new o;return t&&e.mixIn(t),e.hasOwnProperty("init")||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},r=n.WordArray=s.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=void 0!=e?e:4*t.length},toString:function(t){return(t||l).stringify(this)},concat:function(t){var e=this.words,i=t.words,n=this.sigBytes;if(t=t.sigBytes,this.clamp(),n%4)for(var o=0;o<t;o++)e[n+o>>>2]|=(i[o>>>2]>>>24-o%4*8&255)<<24-(n+o)%4*8;else if(65535<i.length)for(o=0;o<t;o+=4)e[n+o>>>2]=i[o>>>2];else e.push.apply(e,i);return this.sigBytes+=t,this},clamp:function(){var e=this.words,i=this.sigBytes;e[i>>>2]&=4294967295<<32-i%4*8,e.length=t.ceil(i/4)},clone:function(){var t=s.clone.call(this);return t.words=this.words.slice(0),t},random:function(e){for(var i=[],n=0;n<e;n+=4)i.push(4294967296*t.random()|0);return new r.init(i,e)}}),a=i.enc={},l=a.Hex={stringify:function(t){var e=t.words;t=t.sigBytes;for(var i=[],n=0;n<t;n++){var o=e[n>>>2]>>>24-n%4*8&255;i.push((o>>>4).toString(16)),i.push((15&o).toString(16))}return i.join("")},parse:function(t){for(var e=t.length,i=[],n=0;n<e;n+=2)i[n>>>3]|=parseInt(t.substr(n,2),16)<<24-n%8*4;return new r.init(i,e/2)}},c=a.Latin1={stringify:function(t){var e=t.words;t=t.sigBytes;for(var i=[],n=0;n<t;n++)i.push(String.fromCharCode(e[n>>>2]>>>24-n%4*8&255));return i.join("")},parse:function(t){for(var e=t.length,i=[],n=0;n<e;n++)i[n>>>2]|=(255&t.charCodeAt(n))<<24-n%4*8;return new r.init(i,e)}},u=a.Utf8={stringify:function(t){try{return decodeURIComponent(escape(c.stringify(t)))}catch(t){throw Error("Malformed UTF-8 data")}},parse:function(t){return c.parse(unescape(encodeURIComponent(t)))}},d=n.BufferedBlockAlgorithm=s.extend({reset:function(){this._data=new r.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=u.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var i=this._data,n=i.words,o=i.sigBytes,s=this.blockSize,a=o/(4*s),a=e?t.ceil(a):t.max((0|a)-this._minBufferSize,0);if(e=a*s,o=t.min(4*e,o),e){for(var l=0;l<e;l+=s)this._doProcessBlock(n,l);l=n.splice(0,e),i.sigBytes-=o}return new r.init(l,o)},clone:function(){var t=s.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0});n.Hasher=d.extend({cfg:s.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){d.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,i){return new t.init(i).finalize(e)}},_createHmacHelper:function(t){return function(e,i){return new h.HMAC.init(t,i).finalize(e)}}});var h=i.algo={};return i}(Math);!function(){var t=n,e=t.lib.WordArray;t.enc.Base64={stringify:function(t){var e=t.words,i=t.sigBytes,n=this._map;t.clamp(),t=[];for(var o=0;o<i;o+=3)for(var s=(e[o>>>2]>>>24-o%4*8&255)<<16|(e[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|e[o+2>>>2]>>>24-(o+2)%4*8&255,r=0;4>r&&o+.75*r<i;r++)t.push(n.charAt(s>>>6*(3-r)&63));if(e=n.charAt(64))for(;t.length%4;)t.push(e);return t.join("")},parse:function(t){var i=t.length,n=this._map,o=n.charAt(64);o&&-1!=(o=t.indexOf(o))&&(i=o);for(var o=[],s=0,r=0;r<i;r++)if(r%4){var a=n.indexOf(t.charAt(r-1))<<r%4*2,l=n.indexOf(t.charAt(r))>>>6-r%4*2;o[s>>>2]|=(a|l)<<24-s%4*8,s++}return e.create(o,s)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(t){function e(t,e,i,n,o,s,r){return((t=t+(e&i|~e&n)+o+r)<<s|t>>>32-s)+e}function i(t,e,i,n,o,s,r){return((t=t+(e&n|i&~n)+o+r)<<s|t>>>32-s)+e}function o(t,e,i,n,o,s,r){return((t=t+(e^i^n)+o+r)<<s|t>>>32-s)+e}function s(t,e,i,n,o,s,r){return((t=t+(i^(e|~n))+o+r)<<s|t>>>32-s)+e}for(var r=n,a=r.lib,l=a.WordArray,c=a.Hasher,a=r.algo,u=[],d=0;64>d;d++)u[d]=4294967296*t.abs(t.sin(d+1))|0;a=a.MD5=c.extend({_doReset:function(){this._hash=new l.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(t,n){for(var r=0;16>r;r++){var a=n+r,l=t[a];t[a]=16711935&(l<<8|l>>>24)|4278255360&(l<<24|l>>>8)}var r=this._hash.words,a=t[n+0],l=t[n+1],c=t[n+2],d=t[n+3],h=t[n+4],p=t[n+5],m=t[n+6],f=t[n+7],g=t[n+8],b=t[n+9],w=t[n+10],v=t[n+11],k=t[n+12],x=t[n+13],y=t[n+14],_=t[n+15],C=r[0],F=r[1],S=r[2],z=r[3],C=e(C,F,S,z,a,7,u[0]),z=e(z,C,F,S,l,12,u[1]),S=e(S,z,C,F,c,17,u[2]),F=e(F,S,z,C,d,22,u[3]),C=e(C,F,S,z,h,7,u[4]),z=e(z,C,F,S,p,12,u[5]),S=e(S,z,C,F,m,17,u[6]),F=e(F,S,z,C,f,22,u[7]),C=e(C,F,S,z,g,7,u[8]),z=e(z,C,F,S,b,12,u[9]),S=e(S,z,C,F,w,17,u[10]),F=e(F,S,z,C,v,22,u[11]),C=e(C,F,S,z,k,7,u[12]),z=e(z,C,F,S,x,12,u[13]),S=e(S,z,C,F,y,17,u[14]),F=e(F,S,z,C,_,22,u[15]),C=i(C,F,S,z,l,5,u[16]),z=i(z,C,F,S,m,9,u[17]),S=i(S,z,C,F,v,14,u[18]),F=i(F,S,z,C,a,20,u[19]),C=i(C,F,S,z,p,5,u[20]),z=i(z,C,F,S,w,9,u[21]),S=i(S,z,C,F,_,14,u[22]),F=i(F,S,z,C,h,20,u[23]),C=i(C,F,S,z,b,5,u[24]),z=i(z,C,F,S,y,9,u[25]),S=i(S,z,C,F,d,14,u[26]),F=i(F,S,z,C,g,20,u[27]),C=i(C,F,S,z,x,5,u[28]),z=i(z,C,F,S,c,9,u[29]),S=i(S,z,C,F,f,14,u[30]),F=i(F,S,z,C,k,20,u[31]),C=o(C,F,S,z,p,4,u[32]),z=o(z,C,F,S,g,11,u[33]),S=o(S,z,C,F,v,16,u[34]),F=o(F,S,z,C,y,23,u[35]),C=o(C,F,S,z,l,4,u[36]),z=o(z,C,F,S,h,11,u[37]),S=o(S,z,C,F,f,16,u[38]),F=o(F,S,z,C,w,23,u[39]),C=o(C,F,S,z,x,4,u[40]),z=o(z,C,F,S,a,11,u[41]),S=o(S,z,C,F,d,16,u[42]),F=o(F,S,z,C,m,23,u[43]),C=o(C,F,S,z,b,4,u[44]),z=o(z,C,F,S,k,11,u[45]),S=o(S,z,C,F,_,16,u[46]),F=o(F,S,z,C,c,23,u[47]),C=s(C,F,S,z,a,6,u[48]),z=s(z,C,F,S,f,10,u[49]),S=s(S,z,C,F,y,15,u[50]),F=s(F,S,z,C,p,21,u[51]),C=s(C,F,S,z,k,6,u[52]),z=s(z,C,F,S,d,10,u[53]),S=s(S,z,C,F,w,15,u[54]),F=s(F,S,z,C,l,21,u[55]),C=s(C,F,S,z,g,6,u[56]),z=s(z,C,F,S,_,10,u[57]),S=s(S,z,C,F,m,15,u[58]),F=s(F,S,z,C,x,21,u[59]),C=s(C,F,S,z,h,6,u[60]),z=s(z,C,F,S,v,10,u[61]),S=s(S,z,C,F,c,15,u[62]),F=s(F,S,z,C,b,21,u[63]);r[0]=r[0]+C|0,r[1]=r[1]+F|0,r[2]=r[2]+S|0,r[3]=r[3]+z|0},_doFinalize:function(){var e=this._data,i=e.words,n=8*this._nDataBytes,o=8*e.sigBytes;i[o>>>5]|=128<<24-o%32;var s=t.floor(n/4294967296);for(i[15+(o+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),i[14+(o+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),e.sigBytes=4*(i.length+1),this._process(),e=this._hash,i=e.words,n=0;4>n;n++)o=i[n],i[n]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8);return e},clone:function(){var t=c.clone.call(this);return t._hash=this._hash.clone(),t}}),r.MD5=c._createHelper(a),r.HmacMD5=c._createHmacHelper(a)}(Math),function(){var t=n,e=t.lib,i=e.Base,o=e.WordArray,e=t.algo,s=e.EvpKDF=i.extend({cfg:i.extend({keySize:4,hasher:e.MD5,iterations:1}),init:function(t){this.cfg=this.cfg.extend(t)},compute:function(t,e){for(var i=this.cfg,n=i.hasher.create(),s=o.create(),r=s.words,a=i.keySize,i=i.iterations;r.length<a;){l&&n.update(l);var l=n.update(t).finalize(e);n.reset();for(var c=1;c<i;c++)l=n.finalize(l),n.reset();s.concat(l)}return s.sigBytes=4*a,s}});t.EvpKDF=function(t,e,i){return s.create(i).compute(t,e)}}(),n.lib.Cipher||function(t){var e=n,i=e.lib,o=i.Base,s=i.WordArray,r=i.BufferedBlockAlgorithm,a=e.enc.Base64,l=e.algo.EvpKDF,c=i.Cipher=r.extend({cfg:o.extend(),createEncryptor:function(t,e){return this.create(this._ENC_XFORM_MODE,t,e)},createDecryptor:function(t,e){return this.create(this._DEC_XFORM_MODE,t,e)},init:function(t,e,i){this.cfg=this.cfg.extend(i),this._xformMode=t,this._key=e,this.reset()},reset:function(){r.reset.call(this),this._doReset()},process:function(t){return this._append(t),this._process()},finalize:function(t){return t&&this._append(t),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(t){return{encrypt:function(e,i,n){return("string"==typeof i?f:m).encrypt(t,e,i,n)},decrypt:function(e,i,n){return("string"==typeof i?f:m).decrypt(t,e,i,n)}}}});i.StreamCipher=c.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var u=e.mode={},d=function(t,e,i){var n=this._iv;n?this._iv=void 0:n=this._prevBlock;for(var o=0;o<i;o++)t[e+o]^=n[o]},h=(i.BlockCipherMode=o.extend({createEncryptor:function(t,e){return this.Encryptor.create(t,e)},createDecryptor:function(t,e){return this.Decryptor.create(t,e)},init:function(t,e){this._cipher=t,this._iv=e}})).extend();h.Encryptor=h.extend({processBlock:function(t,e){var i=this._cipher,n=i.blockSize;d.call(this,t,e,n),i.encryptBlock(t,e),this._prevBlock=t.slice(e,e+n)}}),h.Decryptor=h.extend({processBlock:function(t,e){var i=this._cipher,n=i.blockSize,o=t.slice(e,e+n);i.decryptBlock(t,e),d.call(this,t,e,n),this._prevBlock=o}}),u=u.CBC=h,h=(e.pad={}).Pkcs7={pad:function(t,e){for(var i=4*e,i=i-t.sigBytes%i,n=i<<24|i<<16|i<<8|i,o=[],r=0;r<i;r+=4)o.push(n);i=s.create(o,i),t.concat(i)},unpad:function(t){t.sigBytes-=255&t.words[t.sigBytes-1>>>2]}},i.BlockCipher=c.extend({cfg:c.cfg.extend({mode:u,padding:h}),reset:function(){c.reset.call(this);var t=this.cfg,e=t.iv,t=t.mode;if(this._xformMode==this._ENC_XFORM_MODE)var i=t.createEncryptor;else i=t.createDecryptor,this._minBufferSize=1;this._mode=i.call(t,this,e&&e.words)},_doProcessBlock:function(t,e){this._mode.processBlock(t,e)},_doFinalize:function(){var t=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){t.pad(this._data,this.blockSize);var e=this._process(!0)}else e=this._process(!0),t.unpad(e);return e},blockSize:4});var p=i.CipherParams=o.extend({init:function(t){this.mixIn(t)},toString:function(t){return(t||this.formatter).stringify(this)}}),u=(e.format={}).OpenSSL={stringify:function(t){var e=t.ciphertext;return t=t.salt,(t?s.create([1398893684,1701076831]).concat(t).concat(e):e).toString(a)},parse:function(t){t=a.parse(t);var e=t.words;if(1398893684==e[0]&&1701076831==e[1]){var i=s.create(e.slice(2,4));e.splice(0,4),t.sigBytes-=16}return p.create({ciphertext:t,salt:i})}},m=i.SerializableCipher=o.extend({cfg:o.extend({format:u}),encrypt:function(t,e,i,n){n=this.cfg.extend(n);var o=t.createEncryptor(i,n);return e=o.finalize(e),o=o.cfg,p.create({ciphertext:e,key:i,iv:o.iv,algorithm:t,mode:o.mode,padding:o.padding,blockSize:t.blockSize,formatter:n.format})},decrypt:function(t,e,i,n){return n=this.cfg.extend(n),e=this._parse(e,n.format),t.createDecryptor(i,n).finalize(e.ciphertext)},_parse:function(t,e){return"string"==typeof t?e.parse(t,this):t}}),e=(e.kdf={}).OpenSSL={execute:function(t,e,i,n){return n||(n=s.random(8)),t=l.create({keySize:e+i}).compute(t,n),i=s.create(t.words.slice(e),4*i),t.sigBytes=4*e,p.create({key:t,iv:i,salt:n})}},f=i.PasswordBasedCipher=m.extend({cfg:m.cfg.extend({kdf:e}),encrypt:function(t,e,i,n){return n=this.cfg.extend(n),i=n.kdf.execute(i,t.keySize,t.ivSize),n.iv=i.iv,t=m.encrypt.call(this,t,e,i.key,n),t.mixIn(i),t},decrypt:function(t,e,i,n){return n=this.cfg.extend(n),e=this._parse(e,n.format),i=n.kdf.execute(i,t.keySize,t.ivSize,e.salt),n.iv=i.iv,m.decrypt.call(this,t,e,i.key,n)}})}(),function(){for(var t=n,e=t.lib.BlockCipher,i=t.algo,o=[],s=[],r=[],a=[],l=[],c=[],u=[],d=[],h=[],p=[],m=[],f=0;256>f;f++)m[f]=128>f?f<<1:f<<1^283;for(var g=0,b=0,f=0;256>f;f++){var w=b^b<<1^b<<2^b<<3^b<<4,w=w>>>8^255&w^99;o[g]=w,s[w]=g;var v=m[g],k=m[v],x=m[k],y=257*m[w]^16843008*w;r[g]=y<<24|y>>>8,a[g]=y<<16|y>>>16,l[g]=y<<8|y>>>24,c[g]=y,y=16843009*x^65537*k^257*v^16843008*g,u[w]=y<<24|y>>>8,d[w]=y<<16|y>>>16,h[w]=y<<8|y>>>24,p[w]=y,g?(g=v^m[m[m[x^v]]],b^=m[m[b]]):g=b=1}var _=[0,1,2,4,8,16,32,64,128,27,54],i=i.AES=e.extend({_doReset:function(){for(var t=this._key,e=t.words,i=t.sigBytes/4,t=4*((this._nRounds=i+6)+1),n=this._keySchedule=[],s=0;s<t;s++)if(s<i)n[s]=e[s];else{var r=n[s-1];s%i?6<i&&4==s%i&&(r=o[r>>>24]<<24|o[r>>>16&255]<<16|o[r>>>8&255]<<8|o[255&r]):(r=r<<8|r>>>24,r=o[r>>>24]<<24|o[r>>>16&255]<<16|o[r>>>8&255]<<8|o[255&r],r^=_[s/i|0]<<24),n[s]=n[s-i]^r}for(e=this._invKeySchedule=[],i=0;i<t;i++)s=t-i,r=i%4?n[s]:n[s-4],e[i]=4>i||4>=s?r:u[o[r>>>24]]^d[o[r>>>16&255]]^h[o[r>>>8&255]]^p[o[255&r]]},encryptBlock:function(t,e){this._doCryptBlock(t,e,this._keySchedule,r,a,l,c,o)},decryptBlock:function(t,e){var i=t[e+1];t[e+1]=t[e+3],t[e+3]=i,this._doCryptBlock(t,e,this._invKeySchedule,u,d,h,p,s),i=t[e+1],t[e+1]=t[e+3],t[e+3]=i},_doCryptBlock:function(t,e,i,n,o,s,r,a){for(var l=this._nRounds,c=t[e]^i[0],u=t[e+1]^i[1],d=t[e+2]^i[2],h=t[e+3]^i[3],p=4,m=1;m<l;m++)var f=n[c>>>24]^o[u>>>16&255]^s[d>>>8&255]^r[255&h]^i[p++],g=n[u>>>24]^o[d>>>16&255]^s[h>>>8&255]^r[255&c]^i[p++],b=n[d>>>24]^o[h>>>16&255]^s[c>>>8&255]^r[255&u]^i[p++],h=n[h>>>24]^o[c>>>16&255]^s[u>>>8&255]^r[255&d]^i[p++],c=f,u=g,d=b;f=(a[c>>>24]<<24|a[u>>>16&255]<<16|a[d>>>8&255]<<8|a[255&h])^i[p++],g=(a[u>>>24]<<24|a[d>>>16&255]<<16|a[h>>>8&255]<<8|a[255&c])^i[p++],b=(a[d>>>24]<<24|a[h>>>16&255]<<16|a[c>>>8&255]<<8|a[255&u])^i[p++],h=(a[h>>>24]<<24|a[c>>>16&255]<<16|a[u>>>8&255]<<8|a[255&d])^i[p++],t[e]=f,t[e+1]=g,t[e+2]=b,t[e+3]=h},keySize:8});t.AES=e._createHelper(i)}(),n.pad.Iso10126={pad:function(t,e){var i=4*e,i=i-t.sigBytes%i;t.concat(n.lib.WordArray.random(i-1)).concat(n.lib.WordArray.create([i<<24],1))},unpad:function(t){t.sigBytes-=255&t.words[t.sigBytes-1>>>2]}},i.exports=n}),define("bower_components/aes/main",["require","./aes"],function(t){var e=t("./aes"),i=e.enc.Utf8.parse("youzan.com.aesiv"),n=e.enc.Utf8.parse("youzan.com._key_");return{encrypt:function(t){return t=e.enc.Utf8.parse(t),e.AES.encrypt(t,n,{mode:e.mode.CBC,padding:e.pad.Iso10126,iv:i}).toString()}}}),define("text!bower_components/login/templates/init.html",[],function(){return'<form class="js-login-form popout-login" method="GET" action="">\n    <div class="header c-green center">\n        <h2>请填写您的手机号码</h2>\n    </div>\n    <fieldset class="wrapper-form font-size-14">\n        <div class="form-item">\n            <label for="phone">手机号</label>\n            <input id="phone" name="phone" type="tel" maxlength="11" autocomplete="off" placeholder="" value="<%= phone %>">\n        </div>\n        <div class="js-help-info font-size-12 error c-orange"></div>\n    </fieldset>\n    <div class="action-container">\n        <input type="submit" class="js-confirm btn btn-green btn-block font-size-14" value="确认手机号码" />\n    </div>\n</form>\n'}),define("text!bower_components/login/templates/login.html",[],function(){return'<form class="js-login-form popout-login" method="GET" action="">\n    <div class="header c-green center">\n        <h2>该号码注册过，请直接登录</h2>\n    </div>\n    <fieldset class="wrapper-form font-size-14">\n        <div class="form-item">\n            <label for="phone">手机号</label>\n            <input id="phone" name="phone" type="tel" maxlength="11" autocomplete="off" placeholder="请输入你的手机号" disabled="disabled" value="<%= phone %>">\n        </div>\n        <div class="form-item">\n            <label for="password">密码</label>\n            <input id="passsword" name="password"  type="password" autocomplete="off" placeholder="请输入登录密码">\n        </div>\n        <div class="js-help-info font-size-12 error c-orange"></div>\n    </fieldset>\n    <div class="action-container">\n        <button type="button" class="js-confirm btn btn-green btn-block font-size-14">\n            <%= showBindText ? \'登录并绑定\' : \'确认\' %>\n        </button>\n    </div>\n    <div class="bottom-tips font-size-12">\n        <span class="c-orange">如果您忘了密码，请</span><a href="javascript:;" class="js-change-pwd c-blue">点此找回密码</a>\n        <a href="javascript:;" class="js-change-phone c-blue pull-right">更换手机号</a>\n    </div>\n</form>\n'}),define("text!bower_components/login/templates/quicklogin.html",[],function(){
return'<form class="js-login-form popout-quick-login" method="GET" action="">\n    <div class="popout-title">验证码登录</div>\n    <span class="close-btn js-quick-login-close"></span>\n    <fieldset class="wrapper-form font-size-14">\n        <div class="form-item">\n            <input id="phone" name="phone" type="tel" maxlength="11" autocomplete="off" placeholder="输入手机号" value="<%= phone %>">\n        </div>\n        <div class="form-item verify-image-wrap js-image-verify hide">\n            <input id="verifycode" name="verifycode" class="js-verify-code item-input"  type="tel" style="width:178px" maxlength="6" autocomplete="off" placeholder="输入验证码">\n            <img class="js-verify-image verify-image" src="">\n        </div>\n        <div class="form-item">\n            <input id="code" name="code"  type="text" style="width:165px" maxlength="6" autocomplete="off" placeholder="输入6位验证码">\n            <button type="button" class="js-auth-code tag btn-auth-code font-size-12 tag-green" data-text="获取验证码">\n                获取验证码\n            </button>\n        </div>\n        <div class="js-help-info font-size-12 error c-orange"></div>\n    </fieldset>\n    <div class="action-container">\n        <button type="button" class="js-confirm btn btn-green btn-block font-size-14">\n            登录\n        </button>\n    </div>\n</form>\n'}),define("text!bower_components/login/templates/register.html",[],function(){return'<form class="js-login-form popout-login" method="GET" action="">\n    <div class="header c-green center">\n        <h2>注册有赞帐号</h2>\n    </div>\n    <fieldset class="wrapper-form font-size-14">\n        <div class="form-item">\n            <label for="phone">手机号</label>\n            <input id="phone" name="phone" type="tel" maxlength="11" autocomplete="off" placeholder="请输入你的手机号" disabled="disabled" value="<%= phone %>">\n        </div>\n        <div class="form-item js-image-verify hide">\n            <label for="verifycode">身份校验</label>\n            <input id="verifycode" name="verifycode" class="js-verify-code item-input"  type="tel" style="width:178px" maxlength="6" autocomplete="off" placeholder="输入右侧数字">\n            <img class="js-verify-image verify-image" src="">\n        </div>\n        <div class="form-item">\n            <label for="code">验证码</label>\n            <input id="code" name="code"  type="text" style="width:178px" maxlength="6" autocomplete="off" placeholder="输入短信验证码">\n            <button type="button" class="js-auth-code tag btn-auth-code tag-green font-size-12" data-text="获取验证码">\n                获取验证码\n            </button>\n        </div>\n        <div class="form-item">\n            <label for="password">密码</label>\n            <input id="passsword" name="password"  type="password" autocomplete="off" maxlength="20" placeholder="请输入8-20位数字和字母组合">\n        </div>\n        <div class="js-help-info font-size-12 error c-orange"></div>\n    </fieldset>\n    <div class="action-container">\n        <button type="button" class="js-confirm btn btn-green btn-block font-size-14">\n            <%= showBindText ? \'注册并绑定\' : \'确认\' %>\n        </button>\n    </div>\n    <div class="bottom-tips font-size-12">\n        <span class="c-orange">如果您忘了密码，请</span><a href="javascript:;" class="js-change-pwd c-blue">点此找回密码</a>\n        <a href="javascript:;" class="js-change-phone c-blue pull-right">更换手机号</a>\n    </div>\n</form>\n'}),define("text!bower_components/login/templates/change_pwd.html",[],function(){return'<form class="js-login-form popout-login" method="GET" action="">\n    <div class="header c-green center">\n        <h2><%if(isSetting){%>设定<%}else{%>找回<%}%>帐号密码</h2>\n    </div>\n    <fieldset class="wrapper-form font-size-14">\n        <div class="form-item">\n            <label for="phone">手机号</label>\n            <input id="phone" name="phone" type="tel" maxlength="11" autocomplete="off" placeholder="请输入你的手机号" disabled="disabled" value="<%= phone %>">\n        </div>\n        <div class="form-item js-image-verify hide">\n            <label for="verifycode">身份校验</label>\n            <input id="verifycode" name="verifycode" class="js-verify-code item-input"  type="tel" style="width:178px" maxlength="6" autocomplete="off" placeholder="输入右侧数字">\n            <img class="js-verify-image verify-image" src="">\n        </div>\n        <div class="form-item">\n            <label for="code">验证码</label>\n            <input id="code" name="code"  type="text" style="width:178px" maxlength="6" autocomplete="off" placeholder="输入短信验证码">\n            <button type="button" class="js-auth-code tag btn-auth-code font-size-12 tag-green" data-text="获取验证码">\n                获取验证码\n            </button>\n        </div>\n        <div class="form-item">\n            <label for="password">密码</label>\n            <input id="passsword" name="password"  type="password" autocomplete="off" placeholder="设置新的8-20位数字和字母组合密码">\n        </div>\n        <div class="js-help-info font-size-12 error c-orange"></div>\n    </fieldset>\n    <div class="action-container">\n        <button type="button" class="js-confirm btn btn-green btn-block font-size-14">确定</button>\n    </div>\n    <div class="bottom-tips pull-right">\n        <a href="javascript:;" class="js-login inline-item c-blue">已有帐号登录</a>\n        <a href="javascript:;" class="js-register inline-item c-blue">注册新帐号</a>\n    </div>\n</form>\n'}),define("zenjs/util/valid",[],function(){window.zenjs=window.zenjs||{};var t={validMobile:function(t){return t=""+t,/^((\+86)|(86))?(1)\d{10}$/.test(t)||/^\+?(9[976]\d|8[987530]\d|6[987]\d|5[90]\d|42\d|3[875]\d|2[98654321]\d|9[8543210]|8[6421]|6[6543210]|5[87654321]|4[987654310]|3[9643210]|2[70]|7|1|)-?\d{1,14}$/.test(t)},validPhone:function(t){return t=""+t,/^0[0-9\-]{10,13}$/.test(t)},validNumber:function(t){return/^\d+$/.test(t)},validEmail:function(t){return/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(t)},validPostalCode:function(t){return t=""+t,/^\d{6}$/.test(t)}};return window.zenjs.Valid=t,t}),window.Zepto&&function(t){t.fn.serializeArray=function(){var e,i,n=[],o=function(t){if(t.forEach)return t.forEach(o);n.push({name:e,value:t})};return this[0]&&t.each(this[0].elements,function(n,s){i=s.type,e=s.name,e&&"fieldset"!=s.nodeName.toLowerCase()&&!s.disabled&&"submit"!=i&&"reset"!=i&&"button"!=i&&"file"!=i&&("radio"!=i&&"checkbox"!=i||s.checked)&&o(t(s).val())}),n},t.fn.serialize=function(){var t=[];return this.serializeArray().forEach(function(e){t.push(encodeURIComponent(e.name)+"="+encodeURIComponent(e.value))}),t.join("&")},t.fn.submit=function(e){if(0 in arguments)this.bind("submit",e);else if(this.length){var i=t.Event("submit");this.eq(0).trigger(i),i.isDefaultPrevented()||this.get(0).submit()}return this}}(Zepto),define("vendor/zepto/form",function(){}),define("zenjs/util/form",["require","exports","module","vendor/zepto/form","jquery"],function(t,e,i){t("vendor/zepto/form");var n=t("jquery");window.zenjs=window.zenjs||{};var o={getFormData:function(t){var e=t.serializeArray(),i={};return n.map(e,function(t){i[t.name]=t.value}),i}};window.zenjs.Form=o,i.exports=o}),define("zenjs/sms_fetch/main",["require","exports","module","bower_components/ajax/ajax","zenjs/util/args","jquery"],function(t,e,i){function n(){this.loadingLock=!1,this.isUsed=void 0}function o(t){t=t||{},this.$el=r(t.el||t.$el||"<div></div>"),this.el=this.$el[0],this.$=function(t){return this.$el.find(t)},this.initialize&&this.initialize(t)}t("bower_components/ajax/ajax");var s=t("zenjs/util/args"),r=t("jquery"),a=function(){};n.prototype={fetch:function(){if(this.isUsed!==!1){var t=this;this.loadingLock=!0,r._ajax({url:window._global.url.www.replace(/^https?:\/\//,"//")+"/common/token/token.jsonp",type:"get",dataType:"jsonp"}).done(function(e){0==e.code?(t.token=e.data,t.loadingLock=!1,t.isUsed=!1):motify.log(e.msg)}).fail(function(){motify.log("token 获取失败")})}},get:function(){return this.isUsed=!0,this.token}};var l=new n;r.extend(o.prototype,{initialize:function(t){this.duration=t.time||60,this.step=t.step||1100,this.codeVerifyClass=t.codeVerifyClass||"js-verify-code",this.verifyType="smsFetch";var e=window._global.url.www.replace(/^https?:\/\//,"//");this.smsFetchUrl=e+"/common/sms/captcha.jsonp",this.imgUrl=e+"/common/sms/imgcaptcha",this.imgVerifyUrl=e+"/common/sms/imgcaptcha.jsonp",this.biz=t.biz||"kdt_account_captcha",this.onTimeChange=t.onTimeChange||a,this.onTimeEnd=t.onTimeEnd||a,this.onTimerStart=t.onTimerStart||a,this.onTimerClose=t.onTimerClose||a,this.onVerifyPictureShow=t.onVerifyPictureShow||a,this.onGetCodeError=t.onGetCodeError||a,this.onVerifyPictureSuccess=t.onVerifyPictureSuccess||a,this.onVerifyPictureError=t.onVerifyPictureError||a,this.platform=t.platform||"",this.subFrom=t.subFrom||"",l.fetch()},setMobile:function(t){t&&(this.mobile=t)},getImageCode:function(){return r.trim(this.$("."+this.codeVerifyClass).val())},getSms:function(t){var e=this;if(l.loadingLock)return void motify.log("数据加载中，稍后再试");if(t=t||{},t.mobile&&(this.mobile=t.mobile),!this.mobile)return!1;var i={smsFetch:e.onSmsFetchHandler,image:e.onImageHandler};return e.startTimer.call(e),(i[e.verifyType]||a).call(e),this},startTimer:function(){this.onTimerStart(),this.btnCountdown(this.duration)},stopTimer:function(){clearTimeout(this.timer),this.onTimerClose()},btnCountdown:function(t){var e=this;this.onTimeChange({second:t}),--t>=0?this.timer=setTimeout(function(){e.btnCountdown(t)},this.step):(this.onTimeEnd(),this.timer="")},onVerifyImageShow:function(t){this.$(".js-image-verify").removeClass("hide"),this.$(".js-verify-image").attr("src",t)},onVerifyImageHide:function(){this.$(".js-image-verify").addClass("hide")},onSmsFetchHandler:function(){var t=1;return function(){var e=this,i={verifyTimes:t,mobile:this.mobile,biz:this.biz,token:l.get()};this.platform&&(i.platform=this.platform),this.subFrom&&(i.sub_from=this.subFrom),r._ajax({url:this.smsFetchUrl,dataType:"jsonp",data:i,success:function(i){if(0==i.code)return void t++;e.stopTimer.call(e),e.onGetCodeError.call(e),10111===i.code?(e.verifyType="image",e.onVerifyImageShow(e.imgUrl),e.onVerifyPictureShow()):(t++,motify.log(i.msg))},error:function(i,n,o){t++,e.stopTimer.call(e),e.onGetCodeError.call(e),motify.log("获取验证码失败，请稍后再试")},complete:function(t,e){}}).always(function(){l.fetch()})}}(),onImageHandler:function(){var t=this,e=this.mobile;r._ajax({url:this.imgVerifyUrl,dataType:"jsonp",data:{mobile:e,captcha_code:this.getImageCode()},success:function(i){if(0===i.code)return t.verifyType="smsFetch",t.mobile=e,t.onVerifyImageHide(),t.onVerifyPictureSuccess(),void t.onSmsFetchHandler();t.stopTimer.call(t),t.onVerifyPictureError.call(t),10100===i.code?(motify.log(i.msg),t.reloadCaptcha()):motify.log(i.msg)},error:function(e,i,n){t.stopTimer.call(t),t.onVerifyPictureError.call(t),motify.log("图形验证失败，重试一下吧~"),t.reloadCaptcha()},complete:function(t,e){}})},reloadCaptcha:function(){var t=s.add(this.imgUrl,{stamp:new Date});this.$el.find(".js-verify-image").attr("src",t)}}),i.exports=o}),define("bower_components/login/main",["require","bower_components/ajax/ajax","jquery","backbone","bower_components/aes/main","text!./templates/init.html","text!./templates/login.html","text!./templates/quicklogin.html","text!./templates/register.html","text!./templates/change_pwd.html","zenjs/util/valid","zenjs/util/form","zenjs/sms_fetch/main","zenjs/util/ua"],function(t){t("bower_components/ajax/ajax");var e=t("jquery"),i=t("backbone"),n=t("bower_components/aes/main"),o=t("text!./templates/init.html"),s=t("text!./templates/login.html"),r=t("text!./templates/quicklogin.html"),a=t("text!./templates/register.html"),l=t("text!./templates/change_pwd.html"),c=t("zenjs/util/valid"),u=t("zenjs/util/form"),d=t("zenjs/sms_fetch/main"),h=t("zenjs/util/ua"),p=window._global||{};return i.View.extend({events:{"click .js-confirm":"onConfirmClicked","click .js-change-phone":"onChangePhoneClicked","click .js-change-pwd":"onChangePwdClicked","click .js-login":"onLoginClicked","click .js-register":"onRegisterClicked","click .js-auth-code":"onAuthcodeClicked","click .js-verify-image":"onVerifyImageClicked","submit .js-login-form":"onConfirmClicked","click .js-quick-login-close":"onQuickLoginClose"},initialize:function(t){t=t||{};var i=this,n=p.url;this.tpl_map={init:_.template(t.initTpl||o),login:_.template(t.loginTpl||s),register:_.template(t.registerTpl||a),changePwd:_.template(t.changePwdTpl||l),quickLogin:_.template(t.quickLoginTpl||r)},this.valid_map={checkPhone:_(this.checkPhone).bind(this),checkPwd:_(this.checkPwd).bind(this),checkCode:_(this.checkCode).bind(this)},this.renderOpt=t.renderOpt||{type:"init",phone:""},this.renderOpt.showBindText=h.isWeixin()||h.isQQ(),this.urlMap={login:t.loginUrl||n.uic+"/buyer/auth/authlogin.json",register:t.registerUrl||n.uic+"/buyer/auth/authRegister.json",changePwd:t.changePwdUrl||n.uic+"/buyer/auth/changePassword.json",confirm:t.confirmUrl||n.uic+"/buyer/auth/authConfirm.json",quickLogin:t.quickLoginUrl||n.uic+"/sso/wap/code/login"},this.source=t.source||2,this.ajaxType=t.ajaxType||"POST",this.afterLogin=t.afterLogin||function(){},this.closeBtnCallBack=t.closeBtnCallBack||function(){};var c,u;h.isMobile()?(c="app",u="wsc",h.isWxd()?u="wxd":h.isWsc()?u="wsc":h.isPf()?u="pf":c="wap"):c="pc",this.sms=new d({biz:"quickLogin"===this.renderOpt.type?"uic_login_without_password":"",el:this.$el,onTimeChange:function(t){var n=t.second;e(i.nAuthCode).text("等待 "+n+"秒")},onTimeEnd:function(){i.nAuthCode.text("再次获取"),i.nAuthCode.prop("disabled",!1),i.nAuthCode.removeClass("disabled"),i.nCodeInput.attr("placeholder","没有收到验证码？")},onTimerStart:function(){i.nAuthCode.prop("disabled",!0),i.nAuthCode.addClass("disabled")},onVerifyPictureError:function(){i.nAuthCode.removeAttr("disabled"),i.nAuthCode.removeClass("disabled"),i.nAuthCode.text("再次获取")},onGetCodeError:function(){i.nAuthCode.removeAttr("disabled"),i.nAuthCode.removeClass("disabled"),i.nAuthCode.text("再次获取")},onVerifyPictureShow:function(){i.nHelpInfo.html("操作过于频繁，请先输入图像验证码再获取")},onVerifyPictureSuccess:function(){i.nHelpInfo.html("")},platform:c,subFrom:u})},render:function(){return this.appLogined?this:(this.$el.html(this.tpl_map[this.renderOpt.type](this.renderOpt)),this.nForm=this.$(".js-login-form"),this.nHelpInfo=this.$(".js-help-info"),this.nPhone=this.$('input[name="phone"]'),this.nPwd=this.$('input[name="password"]'),this.nCodeInput=this.$('input[name="authcode"]'),this.nAuthCode=this.$(".js-auth-code"),this)},show:function(t,e){this.sms.biz="changePwd"==t?"reset_account_passwd":"quickLogin"===t?"uic_login_without_password":"kdt_account_captcha",_.extend(this.renderOpt,{type:t},e||{isSetting:!1}),this.render(this.renderOpt),this.$el.show(this.animationTime)},onQuickLoginClose:function(){this.closeBtnCallBack()},onConfirmClicked:function(t){t.preventDefault();var i=this,o=e(t.target),s=u.getFormData(i.nForm);if(s=_.extend(i.renderOpt,s),!i.validate(s))return!1;s.source=this.source,s.password&&(s.password=n.encrypt(s.password));var r=o.html();if("init"===i.renderOpt.type)i.renderOpt.phone=s.phone,e._ajax({url:this.urlMap.confirm,type:"POST",dataType:"json",timeout:15e3,data:s,xhrFields:{withCredentials:!0},beforeSend:function(){o.html("确认中..."),o.prop("disabled",!0)},success:function(t){switch(+t.code){case 0:i.show("login");break;case 135000003:i.show("register");break;default:i.nHelpInfo.html(t.msg)}},error:function(){i.nHelpInfo.html("出错啦，请重试")},complete:function(){o.html(r),o.prop("disabled",!1)}});else{var a=i.renderOpt.type,l=s;"quickLogin"===a&&(l={mobile:s.phone,verify_code:s.code,source:s.source}),e._ajax({url:this.urlMap[a],type:this.ajaxType,dataType:"json",timeout:15e3,data:l,xhrFields:{withCredentials:!0},beforeSend:function(){o.html("确认中..."),o.prop("disabled",!0)},success:function(t){if(0===t.code){var n=t.data||{},o=[],s=e._ajax({url:"https://uic.koudaitong.com/sso/ticket/auth",type:"GET",dataType:"json",timeout:15e3,data:{ticket:n.ticket||""},xhrFields:{withCredentials:!0}});o.push(s);var r=(p.wap_url||{}).wap||"";/youzan\.com/.test(r)||o.push(e._ajax({url:r+"/buyer/auth/ssoConsist.json",type:"GET",dataType:"json",timeout:15e3,data:{uic_login_token:n.ticket||""},xhrFields:{withCredentials:!0}})),e.when.apply(e,o).always(function(){i.afterLogin(t,{type:a})})}else i.nHelpInfo.html(t.msg)},error:function(){i.nHelpInfo.html("出错啦，请重试")},complete:function(){o.html(r),o.prop("disabled",!1)}})}},onAuthcodeClicked:function(t){t.preventDefault();var e=u.getFormData(this.nForm);e=_.extend(this.renderOpt,e);var i=e.phone;this.sms.setMobile(i),this.sms.getSms()},onChangePhoneClicked:function(t){t.preventDefault(),this.show("init")},onChangePwdClicked:function(t){t.preventDefault(),this.sms.stopTimer(),this.show("changePwd")},onLoginClicked:function(t){t.preventDefault(),this.show("init")},onRegisterClicked:function(t){t.preventDefault(),this.show("init")},onVerifyImageClicked:function(t){t.preventDefault(),t.stopPropagation(),this.sms.reloadCaptcha()},validate:function(){var t={init:["checkPhone"],login:["checkPwd"],register:["checkCode","checkPwd"],changePwd:["checkCode","checkPwd"],quickLogin:["checkCode","checkPhone"]};return function(e){return _.every(t[e.type],_(function(t){return this.valid_map[t](e)}).bind(this))}}(),checkPhone:function(t){return""===t.phone?(this.nHelpInfo.html("请填写您的手机号码"),!1):!!c.validMobile(t.phone)||(this.nHelpInfo.html("请填写11位手机号码"),!1)},checkPwd:function(t){if(""===t.password)return this.nHelpInfo.html("请输入您的密码"),!1;if("login"!==this.renderOpt.type&&t.password.length<8)return this.nHelpInfo.html("亲，密码最短为8位"),!1;if("login"!==this.renderOpt.type&&t.password.length>20)return this.nHelpInfo.html("亲，密码最长为20位"),!1;if("login"!==this.renderOpt.type){if(!function(t){var e=/[a-zA-Z]/g,i=/[0-9]/g,n=0,o=e.test(t),s=i.test(t);return o&&s&&(n=1),n}(t.password))return this.nHelpInfo.html("亲，密码为8-20位数字和字母组合"),!1}return!0},checkCode:function(t){return!!c.validPostalCode(t.code)||(this.nHelpInfo.html("请填写6位短信验证码"),!1)}})}),define("zenjs/util/number",[],function(){return{makeRandomString:function(t){var e="",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";t=t||10;for(var n=0;n<t;n++)e+=i.charAt(Math.floor(Math.random()*i.length));return e}}}),define("bower_components/pop/pop",["require","zenjs/events","zenjs/util/number"],function(t){var e=function(){},i=t("zenjs/events"),n=t("zenjs/util/number");return window.zenjs=window.zenjs||{},i.extend({init:function(t){this._window=$(window);var i=n.makeRandomString();$("body").append('<div id="'+i+'"                 style="display:none; height: 100%;                 position: fixed; top: 0; left: 0; right: 0;                background-color: rgba(0, 0, 0, '+(t.transparent||".7")+');z-index:1000;opacity:0;transition: opacity ease 0.2s;"></div>'),this.nBg=$("#"+i),this.nBg.on("click",$.proxy(function(){this.isCanNotHide||this.hide()},this));var o=n.makeRandomString();$("body").append('<div id="'+o+'" class="'+(t.className||"")+'" style="overflow:hidden;visibility: hidden;"></div>'),this.nPopContainer=$("#"+o),this.nPopContainer.hide(),this.nPopContainer.css({opacity:0,position:"absolute","z-index":1e3}),t.contentViewClass&&(this.contentViewClass=t.contentViewClass,this.contentViewOptions=$.extend({el:this.nPopContainer},t.contentViewOptions||{}),this.contentView=new this.contentViewClass($.extend({onHide:$.proxy(this.hide,this)},this.contentViewOptions)),this.contentView.onHide=$.proxy(this.hide,this)),this.animationTime=t.animationTime||300,this.isCanNotHide=t.isCanNotHide,this.doNotRemoveOnHide=t.doNotRemoveOnHide||!1,this.onShow=t.onShow||e,this.onHide=t.onHide||e,this.onFinishHide=t.onFinishHide||e,this.html=t.html},render:function(t){return this.renderOptions=t||{},this.contentViewClass?this.contentView.render(this.renderOptions):this.html&&this.nPopContainer.html(this.html),this},show:function(){return this.nBg.show().css({opacity:"1","transition-property":"none"}),this.nPopContainer.show(),this.trigger("pop:show:before"),setTimeout($.proxy(function(){this.trigger("pop:show:after"),this.nPopContainer.show().css("visibility","visible"),this._doShow&&this._doShow(),this.onShow()},this),200),this},hide:function(t){t=t||{};var e=t.doNotRemove||this.doNotRemoveOnHide||!1;this._doHide&&this._doHide(),this.trigger("pop:hide:before"),setTimeout($.proxy(function(){this.nBg.css({opacity:0,"transition-property":"opacity"}),this.trigger("pop:hide:after"),setTimeout($.proxy(function(){this.nBg.hide(),this.nPopContainer.hide(),e||this.destroy()},this),200)},this),this.animationTime),this.onHide()},destroy:function(){return this.nPopContainer.remove(),this.nBg.remove(),this.contentView&&this.contentView.remove(),this}})}),define("bower_components/pop/pop_forbid_scroll",["require","./pop"],function(t){return window.zenjs=window.zenjs||{},t("./pop").extend({init:function(t){this._super(t),t.doNotForbidScroll||(this.on("pop:show:before",$.proxy(this.onBeforePopShow,this)),this.on("pop:show:after",$.proxy(this.onAfterPopShow,this)),this.on("pop:hide:after",$.proxy(this.onAfterPopHide,this)))},onBeforePopShow:function(){this.top=this._window.scrollTop()},onAfterPopShow:function(){this._window.scrollTop(0),this.startShow()},onAfterPopHide:function(){var t,e=function(i){if(t!==this._window.scrollTop()&&i>0)return this._window.scrollTop(t),void setTimeout($.proxy(e,this,i-1));setTimeout($.proxy(this.onFinishHide,this),50)};return function(){this.startHide(),t=this.top,this._window.scrollTop(t),$.proxy(e,this)(2),setTimeout($.proxy(function(){window.zenjs.popList.length<1&&$("html").css("position",this.htmlPosition)},this),200)}}(),startShow:function(){var t=window.zenjs.popList;if(t||(t=window.zenjs.popList=[]),0===t.length){var e=$("body"),i=$("html");this.htmlPosition=i.css("position"),i.css("position","relative"),this.bodyCss=(e.prop("style")||{}).cssText,this.htmlCss=(i.prop("style")||{}).cssText,$("body,html").css({overflow:"hidden",height:this._window.height(),"padding-bottom":0,"margin-bottom":0})}t.indexOf(this)<0&&t.push(this)},startHide:function(){var t=window.zenjs.popList,e=t.indexOf(this);e>-1&&t.splice(e,1),t.length<1&&($("html").attr("style",this.htmlCss||""),$("body").attr("style",this.bodyCss||""))}})}),define("bower_components/pop/popout",["require","./pop_forbid_scroll"],function(t){return t("./pop_forbid_scroll").extend({init:function(t){t=t||{},this._super(t),this.css=$.extend({transition:"opacity ease "+this.animationTime+"ms",top:"50%",left:"50%","-webkit-transform":"translate3d(-50%, -50%, 0)",transform:"translateY(-50%, -50%, 0)"},t.css||{}),this.nPopContainer.css(this.css)},_doShow:function(){$(".js-popout-close").click($.proxy(function(t){this.hide()},this)),this.nPopContainer.css("opacity",1),this.nPopContainer.show()},_doHide:function(t){this.nPopContainer.css({opacity:0})}})}),define("bower_components/pop/popout_box",["require","./popout"],function(t){var e=function(){};return t("./popout").extend({init:function(t){this._super(t),this._onOKClicked=t.onOKClicked||e,this._onCancelClicked=t.onCancelClicked||e,this.preventHideOnOkClicked=t.preventHideOnOkClicked||!1,this.width=t.width,this.setEventListener()},setEventListener:function(){this.nPopContainer.on("click",".js-ok",$.proxy(this.onOKClicked,this)),this.nPopContainer.on("click",".js-cancel",$.proxy(this.onCancelClicked,this))},_doShow:function(){this.boxCss={"border-radius":"4px",background:"white",width:this.width||"270px",padding:"15px"},this.nPopContainer.css(this.boxCss).addClass("popout-box"),this._super()},_doHide:function(t){this._super()},onOKClicked:function(t){this._onOKClicked(t),!this.preventHideOnOkClicked&&this.hide()},onCancelClicked:function(t){this._onCancelClicked(t),this.hide()}})}),function(t,e){"function"==typeof define&&define.amd?define("@youzan/date-utils/dist/main",[],e):"object"==typeof exports&&"object"==typeof module?module.exports=e():"object"==typeof exports?exports["date-utils"]=e():t["date-utils"]=e()}(this,function(){return function(t){function e(n){if(i[n])return i[n].exports;var o=i[n]={exports:{},id:n,loaded:!1};return t[n].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){t.exports=i(1)},function(t,e,i){"use strict";function n(t){return!isNaN(new Date(t))}function o(t){return(t=t||new Date)instanceof Date?t:("string"!=typeof t&&"number"!=typeof t||n(t)&&(t=new Date(t)),t)}function s(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD";return t=o(t),c(t,e)}function r(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD HH:mm:ss";return t=o(t),c(t,e)}Object.defineProperty(e,"__esModule",{value:!0}),e.getCurrentDay=e.formatDate=e.parseDate=void 0,e.isValidDate=n,e.getValidDate=o,e.makeDateStr=s,e.makeDateTimeStr=r;var a=i(2),l={zh:{dayNamesShort:["周日","周一","周二","周三","周四","周五","周六"],dayNames:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],monthNamesShort:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],amPm:["am","pm"],DoFn:function(t){return t+["th","st","nd","rd"][t%10>3?0:(t-t%10!=10)*t%10]}}},c=(e.parseDate=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default";if(e=e||"default",t instanceof Date)return t;if("number"==typeof t)return Date.parse(t);var i=(0,a.parse)(t,e);return i?i:(consle.warn("解析失败，传入的 date 和 mask 不匹配"),null)},e.formatDate=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"zh";return t=o(t),(0,a.format)(t,e,l[i])});e.getCurrentDay=s},function(t,e,i){var n;!function(o){"use strict";function s(t,e){for(var i=[],n=0,o=t.length;n<o;n++)i.push(t[n].substr(0,e));return i}function r(t){return function(e,i,n){var o=n[t].indexOf(i.charAt(0).toUpperCase()+i.substr(1).toLowerCase());~o&&(e.month=o)}}function a(t,e){for(t=String(t),e=e||2;t.length<e;)t="0"+t;return t}var l={},c=/d{1,4}|M{1,4}|YY(?:YY)?|S{1,3}|Do|ZZ|([HhMsDm])\1?|[aA]|"[^"]*"|'[^']*'/g,u=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,d=function(){},h=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],p=["January","February","March","April","May","June","July","August","September","October","November","December"],m=s(p,3),f=s(h,3);l.i18n={dayNamesShort:f,dayNames:h,monthNamesShort:m,monthNames:p,amPm:["am","pm"],DoFn:function(t){return t+["th","st","nd","rd"][t%10>3?0:(t-t%10!=10)*t%10]}};var g={D:function(t){return t.getDate()},DD:function(t){return a(t.getDate())},Do:function(t,e){return e.DoFn(t.getDate())},d:function(t){return t.getDay()},dd:function(t){return a(t.getDay())},ddd:function(t,e){return e.dayNamesShort[t.getDay()]},dddd:function(t,e){return e.dayNames[t.getDay()]},M:function(t){return t.getMonth()+1},MM:function(t){return a(t.getMonth()+1)},MMM:function(t,e){return e.monthNamesShort[t.getMonth()]},MMMM:function(t,e){return e.monthNames[t.getMonth()]},YY:function(t){return String(t.getFullYear()).substr(2)},YYYY:function(t){return t.getFullYear()},h:function(t){return t.getHours()%12||12},hh:function(t){return a(t.getHours()%12||12)},H:function(t){return t.getHours()},HH:function(t){return a(t.getHours())},m:function(t){return t.getMinutes()},mm:function(t){return a(t.getMinutes())},s:function(t){return t.getSeconds()},ss:function(t){return a(t.getSeconds())},S:function(t){return Math.round(t.getMilliseconds()/100)},SS:function(t){return a(Math.round(t.getMilliseconds()/10),2)},SSS:function(t){return a(t.getMilliseconds(),3)},a:function(t,e){return t.getHours()<12?e.amPm[0]:e.amPm[1]},A:function(t,e){return t.getHours()<12?e.amPm[0].toUpperCase():e.amPm[1].toUpperCase()},ZZ:function(t){var e=t.getTimezoneOffset();return(e>0?"-":"+")+a(100*Math.floor(Math.abs(e)/60)+Math.abs(e)%60,4)}},b={D:[/\d\d?/,function(t,e){t.day=e}],Do:[new RegExp(/\d\d?/.source+u.source),function(t,e){t.day=parseInt(e,10)}],M:[/\d\d?/,function(t,e){t.month=e-1}],YY:[/\d\d?/,function(t,e){var i=new Date,n=+(""+i.getFullYear()).substr(0,2);t.year=""+(e>68?n-1:n)+e}],h:[/\d\d?/,function(t,e){t.hour=e}],m:[/\d\d?/,function(t,e){t.minute=e}],s:[/\d\d?/,function(t,e){t.second=e}],YYYY:[/\d{4}/,function(t,e){t.year=e}],S:[/\d/,function(t,e){t.millisecond=100*e}],SS:[/\d{2}/,function(t,e){t.millisecond=10*e}],SSS:[/\d{3}/,function(t,e){t.millisecond=e}],d:[/\d\d?/,d],ddd:[u,d],MMM:[u,r("monthNamesShort")],MMMM:[u,r("monthNames")],a:[u,function(t,e,i){var n=e.toLowerCase();n===i.amPm[0]?t.isPm=!1:n===i.amPm[1]&&(t.isPm=!0)}],ZZ:[/[\+\-]\d\d:?\d\d/,function(t,e){var i,n=(e+"").match(/([\+\-]|\d\d)/gi);n&&(i=+(60*n[1])+parseInt(n[2],10),t.timezoneOffset="+"===n[0]?i:-i)}]};b.dd=b.d,b.dddd=b.ddd,b.DD=b.D,b.mm=b.m,b.hh=b.H=b.HH=b.h,b.MM=b.M,b.ss=b.s,b.A=b.a,l.masks={default:"ddd MMM DD YYYY HH:mm:ss",shortDate:"M/D/YY",mediumDate:"MMM D, YYYY",longDate:"MMMM D, YYYY",fullDate:"dddd, MMMM D, YYYY",shortTime:"HH:mm",mediumTime:"HH:mm:ss",longTime:"HH:mm:ss.SSS"},l.format=function(t,e,i){var n=i||l.i18n;if("number"==typeof t&&(t=new Date(t)),"[object Date]"!==Object.prototype.toString.call(t)||isNaN(t.getTime()))throw new Error("Invalid Date in fecha.format");e=l.masks[e]||e||l.masks.default;var o=[];return e=e.replace(/\[([^]*?)\]/gm,function(t,e){return o.push(e),"??"}),e=e.replace(c,function(e){return e in g?g[e](t,n):e.slice(1,e.length-1)}),e.replace(/\?\?/g,function(){return o.shift()})},l.parse=function(t,e,i){var n=i||l.i18n;if("string"!=typeof e)throw new Error("Invalid format in fecha.parse");if(e=l.masks[e]||e,t.length>1e3)return!1;var o=!0,s={};if(e.replace(c,function(e){if(b[e]){var i=b[e],r=t.search(i[0]);~r?t.replace(i[0],function(e){return i[1](s,e,n),t=t.substr(r+e.length),e}):o=!1}return b[e]?"":e.slice(1,e.length-1)}),!o)return!1;var r=new Date;s.isPm===!0&&null!=s.hour&&12!=+s.hour?s.hour=+s.hour+12:s.isPm===!1&&12==+s.hour&&(s.hour=0);var a;return null!=s.timezoneOffset?(s.minute=+(s.minute||0)-+s.timezoneOffset,a=new Date(Date.UTC(s.year||r.getFullYear(),s.month||0,s.day||1,s.hour||0,s.minute||0,s.second||0,s.millisecond||0))):a=new Date(s.year||r.getFullYear(),s.month||0,s.day||1,s.hour||0,s.minute||0,s.second||0,s.millisecond||0),a},void 0!==t&&t.exports?t.exports=l:void 0!==(n=function(){return l}.call(e,i,e,t))&&(t.exports=n)}()}])}),window.Utils=window.Utils||{},$.extend(window.Utils,{needConfirm:function(t,e,i){window.confirm(t)?e&&"function"==typeof e&&e.apply():i&&"function"==typeof i&&i.apply()}}),define("wap/components/util/confirm",function(){}),define("zenjs/util/jump_to_url",["require","bower_components/youzanjsbridge/api"],function(t){var e=t("bower_components/youzanjsbridge/api");return function(t){"youzanmars"==_global.platform?e.gotoWebview({page:"web",url:t}):location.href=t}}),define("text!wap/showcase/sku/templates/buyBtn.html",[],function(){
return'<% if (!isMultiBtn) { %>\n    <div class="big-btn-1-1">\n        <a href="javascript:;" class="js-confirm-it big-btn red-btn main-btn">下一步</a>\n    </div>\n<% } else { %>\n    <% if (!isCartBtnHide && +isVirtual === 0) { %>\n    <div class="big-btn-<%= isBuyBtnHide ? 1 : 2 %>-1">\n        <a href="javascript:;" class="js-mutiBtn-confirm cart big-btn orange-btn vice-btn">加入购物车</a>\n        <% if (!isBuyBtnHide) { %>\n            <a href="javascript:;" class="js-mutiBtn-confirm confirm big-btn red-btn main-btn">立即购买</a>\n        <% } %>\n    </div>\n    <% } else { %>\n        <div class="big-btn-1-1">\n            <a href="javascript:;" class="js-mutiBtn-confirm confirm big-btn red-btn main-btn">下一步</a>\n        </div>\n    <% } %>\n<% } %>\n'}),define("text!wap/showcase/sku/templates/skuContainer.html",[],function(){return'<div class="sku-layout-title name-card sku-name-card">\n</div>\n<div class="sku-detail adv-opts hotel-checkin-select" style="border: none; margin: 0; display: none;">\n    <div class="sku-detail-inner adv-opts-inner-addons">\n        <dl class="sku-group select-sku js-select-checkin-date">\n            <dt>时间：</dt>\n            <dd class="js-checkin-date-value">选择入住时间</dd>\n        </dl>\n    </div>\n</div>\n<div class="adv-opts layout-content">\n    <div class="goods-models js-sku-views block block-list border-top-0"></div>\n    <!-- <div class="bottom-padding"></div> -->\n    <div class="confirm-action content-foot clearfix"></div>\n</div>\n'}),define("text!wap/showcase/sku/templates/quantity.html",[],function(){return'<dl class="clearfix block-item">\n    <dt class="sku-num pull-left">\n        <label><%= is_hotel ? \'购买房间数：\' : \'购买数量：\' %></label>\n    </dt>\n    <dd class="sku-quantity-contaienr"></dd>\n    <dt class="other-info"></dt>\n</dl>\n'}),define("text!wap/showcase/sku/templates/quota.html",[],function(){return'<% if (isVirtual) { %>\n  <% if (!hasLimit) { %>\n    <div class="quota hide">一次最多能买100件</div>\n  <% } else { %>\n    <% if (singleQuota < 100) { %>\n      <div class="quota">每人限购<%- quota %>件</div>\n    <% } else { %>\n      <div class="quota">每人限购<%- quota %>件，一次最多能买100件</div>\n    <% } %>\n  <% } %>\n<% } else { %>\n<div class="quota">每人限购<%- quota %><%- is_hotel == 1 ? \'间*晚\' : \'件\' %></div>\n<% } %>\n'}),define("css",[],function(){var t={};return t.normalize=function(t,e){return".css"==t.substr(t.length-4,4)&&(t=t.substr(0,t.length-4)),e(t)},t}),define("css!components_css/sku_layout",[],function(){}),require(["zenjs/util/ua","bower_components/wap_common/base/make_url_log","bower_components/youzanjsbridge/api","zenjs/backbone/quantity","bower_components/wap_common/base/page_type","wap/showcase/sku/views/message","wap/showcase/sku/views/sku_selector","wap/showcase/sku/views/sku_stock","wap/showcase/sku/views/sku_title","bower_components/login/main","bower_components/pop/popout_box","bower_components/ajax/ajax","@youzan/date-utils/dist/main","wap/components/util/confirm","zenjs/util/args","vendor/zepto/form","zenjs/util/jump_to_url","text!wap/showcase/sku/templates/buyBtn.html","text!wap/showcase/sku/templates/skuContainer.html","text!wap/showcase/sku/templates/quantity.html","text!wap/showcase/sku/templates/quota.html","zenjs/util/cookie","css!components_css/sku_layout"],function(t,e,i,n,o,s,r,a,l,c,u,d,h,p,m,f,g,b,w,v,k,x){var y=function(){};Backbone.SKUEventCenter=Backbone.SKUEventCenter||_.extend({},Backbone.Events);var C=Backbone.View.extend({initialize:function(t){t=t||{},this.skuViewConfig=_.extend({bottom:0,left:0,right:0,top:40},t.skuViewConfig||{}),this.baseUrl=t.baseUrl,this.need_ajax_login=t.need_ajax_login||!1,this.wxpay_env=t.wxpay_env,this.isCartBtnHide=t.isCartBtnHide,this.isBuyBtnHide=t.isBuyBtnHide===!0,this.quantityReadOnly=t.quantityReadOnly,this.isPriceCanChanged=!0,this.isPointsPriceCanChanged=!0,this.onAddSuccess=t.onAddSuccess||y,this.onSubmitClick=t.onSubmitClick,this.inited=!1,this.SkuTitleView=t.SkuTitleView||l,this.quotaTpl=t.quotaTpl||k,this.onHide=t.onHide||y,this.viewTop=this.skuViewConfig.top,delete this.skuViewConfig.top,this.deviceView={width:$(document).width(),height:$(document).height()},this.bodyPos=$("html").css("position"),this.nActionBtnTemplate=_.template(b),this.nPrice=this.$(".js-goods-price"),this.nPointsPrice=this.$(".js-points-price"),Backbone.SKUEventCenter.on("sku:selected",_(this.onSelectChange).bind(this)),Backbone.SKUEventCenter.on("sku:set:price",_(this.setPrice).bind(this)),Backbone.SKUEventCenter.on("sku:set:stock",_(this.setStock).bind(this))},render:function(t){t=t||{},this.sku=t.sku||{},this.goods_id=t.goods_id,this.points_goods=t.points_goods,this.store_id=window._global.offline_id,this.kdt_id=t.kdt_id||window._global.kdt_id,this.postage=t.postage,this.activity=t.activity,this.activity_alias=t.activity_alias||"",this.activity_id=t.activity_id||0,this.activity_type=t.activity_type||0,this.quota=t.quota||0,this.quota_used=t.quota_used||0,this.stockNum=t.stock||this.sku.stock_num,this.isGift=t.isGift,this.is_virtual=void 0!==t.is_virtual?t.is_virtual:window._global.is_virtual,this.isPoints=t.isPoints,this.isHotel=window._global.isHotel,this.hotelConfig=t.hotelConfig,this.isAddCart=t.isAddCart,this.isAddWish=t.isAddWish,this.isHideNumberSelect=t.isHideNumberSelect;var e=t.confirmBtnText;if(this.groupBuyLimit=t.groupBuyLimit||0,this.isMultiBtn=t.isMultiBtn||!1,this.onAfterHideFunc=t.onAfterHideFunc||y,this.goods_info=t.goods_info||{title:"",picture:[],price:"",points_price:"",origin:""},this.item_id=t.item_id||"",this.is_buy=t.is_buy||"",this.show_stock=t.show_stock!==!1,this.isVirtual=3==this.is_virtual,this.hasLimit=!!this.quota,this.isVirtual&&(this.singleQuota=this.quota-this.quota_used||100,this.quota=this.quota||100),!this.inited){this.inited=!0,this.$el.append(w);var i=this.$(".sku-layout-title");this.skuTitleView=new this.SkuTitleView({el:i}).render({goods_info:this.goods_info,activity:this.activity,sku:this.sku,points_goods:this.points_goods,isPoints:this.isPoints}),this.isHotel&&($(".hotel-checkin-select").show(),$(".js-checkin-date-value").text($(".content-body .js-checkin-date-value").text()||"选择入住时间")),this.$(".js-sku-views").empty();var o=this.$(".js-sku-views");if(this.skuSelectorView=new r({sku:this.sku,goods_info:this.goods_info}).render(),o.append(this.skuSelectorView.$el.children()),!this.isAddWish&&!this.isHideNumberSelect){var l=this.quantityLimit=this.getLimitNum(this.quota,this.quota_used,this.stockNum),c=_.template(v)({is_hotel:this.isHotel}),u=$(c);this.quantityView=new n({readonly:this.quantityReadOnly,num:1,tagName:"dl",className:"clearfix",limitNum:+l.limitNum,minimalNum:this.isAddWish?0:1,onOverLimit:_(function(t){var e=this.isHotel?"间*晚":"件",i=this.quota_used>0?"<br>你之前已经购买过"+this.quota_used+e:"";return l=this.quantityLimit,"quota"===l.limitType?void(this.isVirtual?this.singleQuota<100&&+t>this.singleQuota?motify.log("该商品每人限购"+this.quota+e+i):this.singleQuota>=100&&+t>100&&motify.log("一次最多能买100件"):motify.log("该商品每人限购"+this.quota+e+i)):"stock"===l.limitType?void motify.log("就这么几件啦～"):void 0}).bind(this),onNumChange:_(function(){var t,e;return _(function(i){this.isVirtual&&!this.hasLimit&&(e||(e=$(".other-info .quota")),i>=+this.quantityLimit.limitNum?e.removeClass("hide"):e.addClass("hide")),this.isAddWish&&(0===i?t?t.show():(t=$('<div class="c-red text-right">0表示不限制赠送数量</div>'),this.quantityView.$el.parent().append(t)):t.hide())}).bind(this)}).bind(this)()}).render(),o.append(u),this.quantityView.$el.appendTo(u.find(".sku-quantity-contaienr"));var d=u.find(".other-info");if(this.show_stock&&!this.sku.hide_stock&&(this.stockView=new a({el:$('<div class="stock"></div>'),hide_stock:this.sku.hide_stock,is_hotel:this.isHotel}).render({stock:this.stockNum}),this.stockView.$el.appendTo(d)),this.quota||this.isVirtual){var h=_.template(this.quotaTpl)({hasLimit:this.hasLimit,quota:this.quota,singleQuota:this.singleQuota,isVirtual:this.isVirtual,is_hotel:this.isHotel});$(h).appendTo(d)}}this.messageView=new s({messages:this.sku.messages,className:"block-item block-item-messages"}),o.append(this.messageView.render().el),this.skuSelectorView.autoSelect()}return this.$(".confirm-action").html(this.nActionBtnTemplate({isMultiBtn:this.isMultiBtn,isCartBtnHide:this.isCartBtnHide,isBuyBtnHide:this.isBuyBtnHide,isVirtual:this.is_virtual})),this.nConfirmBtn=0===this.$(".js-confirm-it").length?this.$(".js-mutiBtn-confirm.confirm"):this.$(".js-confirm-it"),l&&0===l.limitNum&&this.nConfirmBtn.attr("disabled",!0),this.isMultiBtn?this.nConfirmBtn.data("text","立即购买"):(e=e||(this.isAddCart?"加入购物车":"下一步"),this.nConfirmBtn.text(e),this.nConfirmBtn.data("text",e)),this.$el.css(this.skuViewConfig),!this.isAddWish||this.sku.messages&&0!==this.sku.messages.length||!this.sku.none_sku||o&&o.hide(),t.selectedSkuId&&this.skuSelectorView.doActiveSelectedSku(t.selectedSkuId),this},events:{"click .js-confirm-it":"doConfirmClicked","click .js-cancel":"onCancelClicked","click .js-mutiBtn-confirm":"onMultiBtnClick"},onSelectChange:function(t){var e=t.skuComb,i=t.skuThumb,n=this.stockNum;i&&this.skuTitleView.changeSkuThumb(i),e?(this.quantityView&&(this.quantityView&&this.quantityView.setMinimalNum(1),this.quantityView&&this.quantityView.changeNum(1)),this.isHotel||(n=Math.min(this.stockNum,parseInt(e.get("stock_num"),10)),this.stockView&&this.stockView.setNum(n),this.setPrice(e.get("price")),this.updateSkuTitleView(e))):(this.stockView&&this.stockView.setNum(this.stockNum),this.isHotel||this.resetSkuTitleView()),this.quantityView&&(this.quantityLimit=this.getLimitNum(this.quota,this.quota_used,n),this.quantityView.setLimitNum(this.quantityLimit.limitNum))},resetSkuTitleView:function(){this.skuTitleView.resetPrice(),this.skuTitleView.resetPriceTitle()},setPrice:function(t,e){var i;this.isPriceCanChanged&&(this.skuTitleView.changePrice(t),e&&(i=t===e,this.skuTitleView.changeOldPrice(e,i)))},setStock:function(t){this.stockNum=parseInt(t,10),this.stockView&&this.stockView.setNum(this.stockNum),this.quantityLimit=this.getLimitNum(this.quota,this.quota_used,t),this.quantityView&&(this.quantityView.setLimitNum(this.quantityLimit.limitNum),this.quantityView.updateBtnStatus(this.quantityView.num))},updateSkuTitleView:function(t){this.setPrice(t.get("price"),t.get("old_price")),this.isPointsPriceCanChanged&&this.skuTitleView.changePointsPrice(t.toJSON()),this.skuTitleView.changePriceTitle(t.get("price_title"))},disablePriceChange:function(){this.isPriceCanChanged=!1},disablePointsPriceChange:function(){this.isPointsPriceCanChanged=!1},onMultiBtnClick:function(t){t=t||window.event;var e=t.target||t.srcElement;this.isAddCart=$(e).hasClass("cart"),this.doConfirmClicked(t)},doConfirmClicked:function(t){function e(){i.doSubmit({isPoints:i.isPoints,buyType:n})}if(!$(t.target).attr("disabled")){var i=this,n=this.getBuyType(),o={fm:"click",title:n};t&&window.Logger?(this.isPoints&&_.extend(o,{spm:"itg"+this.goods_id,act_name:"intermall",title:"next"}),window.Logger&&Logger.log(o).then(e,function(){motify.log("亲，请稍等。")})):e()}},getHotelGoodsList:function(t,e){var i=[],n=this.hotelConfig.hotelSkuData,o=new Date(this.hotelConfig.selectedDate[0].getTime()),s=new Date(this.hotelConfig.selectedDate[1].getTime());s.setDate(s.getDate()-1);for(var r=h.getCurrentDay(o);o<=s;){var a=n[r];if(a&&a.length>0){var l=_.find(a,function(e){return e.item_sku_id===t.sku_id});if(l){var c=$.extend({goods_id:t.goods_id,num:t.num,sku_id:l.hotel_sku_id,price:l.price},e);i.push(c)}}o.setDate(o.getDate()+1),r=h.getCurrentDay(o)}return i},doSubmit:function(){var n=function(t){var i=this,n=this.messageView.getData();if(n){var s=$.extend({goods_id:t.goods_id,num:t.num,sku_id:t.sku_id,price:t.price,points_price:t.points_price},n),r=[s],a={log:{act_name:"intermall"}};this.isHotel&&(r=this.getHotelGoodsList(t,n));var l=x("dc_ps")||"",c=x("qr")||"";_.each(r,function(t){t.dc_ps=l,t.qr=c});var u={is_buy:this.is_buy,item_id:this.item_id};delete t.goods_id,delete t.num,delete t.sku_id,delete t.sku_names,delete t.price,delete t.points_price,t.order_from="";var h={goodsList:JSON.stringify(r),common:JSON.stringify(t)};this.isPoints&&(h.extra=JSON.stringify(a)),u.item_id&&(h.pinjian=JSON.stringify(u)),d({url:"/v2/trade/common/cache.json",type:"POST",dataType:"json",data:h,timeout:15e3,beforeSend:function(){i.ajaxing=!0,i.doDisabled(i.nConfirmBtn,!0),i.nConfirmBtn.html("数据提交中")},success:function(n){var s=+n.code,r=n.data;if(0!==s)return Backbone.SKUEventCenter.trigger("order_error",s),(window.errorCodeWhiteList||[]).indexOf(s)<0&&motify.log(n.msg),i.doDisabled(i.nConfirmBtn,!1),void i.nConfirmBtn.html("立即购买");var a=window._global.url.trade+r.url;a=m.add(a,{showwxpaytitle:1,kdt_id:i.kdt_id}),t.from&&(a=m.add(a,{from:t.from})),t.use_wxpay&&(a=m.add(a,{use_wxpay:t.use_wxpay})),t.loginTicket&&(a=m.add(a,{uic_login_token:t.loginTicket})),a=e(a),a=m.add(a,{page_type:o.getPageType(),page_version:_global.page_version||"unknown",platform:_global.platform});var l=m.add(a,{book_key:r.key});if(i.doHideSkuView(),window.appEngineConfig){var c=(JSON.parse((window.appEngineConfig||{}).rule||{}).sku||{}).buyUrl;if(c)return c=m.add(c,{url:l,bookId:r.key}),g(c)}g(l)},error:function(t,e,n){motify.log("购买失败，请重试。[error: "+e+"]"),i.submitError("buy",t,e,n)},complete:function(){i.ajaxing=!1}})}},s=function(e){var n=this,o=this.baseUrl;delete e.sku_names,d({url:o+"/trade/cart/goods.jsonp",type:"GET",dataType:"jsonp",cache:!1,timeout:15e3,data:e,beforeSend:function(){n.ajaxing=!0},success:function(s){var r=+s.code;if(0===r){t&&"youzanmars"===_global.platform&&t.getPlatformVersion()>="1.6.2"||motify.log("已成功添加到购物车"),n.onAddSuccess({wish:!1,cart:!0,buy:!1},e),window.eventHandler&&(window.eventHandler.trigger("cart:add",s,e),window.eventHandler.trigger("global_icon:new"));var a="";n.goods_info&&n.goods_info.picture&&(a=n.goods_info.picture[0]),i.doAction({action:"addToCart",goods_cover:a}),n.doHideSkuView()}else if(40015===r){var l=s.data||{},c=o+"/trade/wxlogin",u=l.cart_key||"";c=m.add(c,{cart_key:u,kdt_id:n.kdt_id,redirect_uri:location.href}),n.doHideSkuView(),g(c)}else motify.log(s.msg)},error:function(t,e,i){n.ajaxing=!1,n.submitError("add-cart",t,e,i)},complete:function(){n.ajaxing=!1}})},r=function(t){var e=this;delete t.sku_names,d({url:"/v2/trade/wish/add.json?kdt_id="+e.kdt_id,type:"POST",dataType:"json",cache:!1,timeout:15e3,data:t,beforeSend:function(){e.ajaxing=!0,e.nConfirmBtn.html("提交中..."),e.doDisabled(e.nConfirmBtn,!0)},success:function(i){e.ajaxing=!1,e.submitSuccess(i,t)},error:function(t,i,n){e.ajaxing=!1,e.submitError("add-wish",t,i,n)}})},a={"add-cart":s,buy:n,"add-wish":r,gift:n},l=function(t,e){if(this.onSubmitClick)return this.onSubmitClick(t),void this.doHideSkuView();(a[e.buyType]||y).call(this,t)},p=function(){var t,e=this.skuSelectorView.getSelectedSku(),i=this.messageView.getData(),n=this.quantityView?this.quantityView.getNum():1;if(!e.status)return motify.log("请选择 "+e.errMsg),!1;if(!i)return!1;if(!n)return motify.log("亲，是不是数量不对？"),!1;t=e.sku;var o={kdt_id:this.kdt_id,goods_id:this.goods_id,postage:this.postage||0,num:n,activity_alias:this.activity_alias,activity_id:this.activity_id,activity_type:this.activity_type,sku_id:t.id,sku_names:t.get("sku_names")||[],price:parseInt(this.skuTitleView.getPrice(),10)||t.get("price"),points_price:this.skuTitleView.getPointsPrice()||t.get("points_price")},s=(m.get||function(){})("from");if(s&&s.length>0&&(o.from=s),o.use_wxpay=this.wxpay_env?1:0,this.isHotel){if(2!==this.hotelConfig.selectedDate.length)return motify.log("亲，请选择入住时间"),!1;var r=this.hotelConfig.selectedDate;o.hotel_goods={},o.hotel_goods[this.goods_id]=[],o.hotel_goods[this.goods_id][0]=h.getCurrentDay(r[0]),o.hotel_goods[this.goods_id][1]=h.getCurrentDay(r[1])}return _(o).extend(i),o};return function(t){if(!t.notCheckBtnDisabled&&this.isDisabled(this.nConfirmBtn))return!1;if(this.ajaxing)return void motify.log("提交订单中，请勿重复提交。");var e=p.call(this);if(e){if(this.isPoints&&(e.is_points=1),this.store_id&&(e.store_id=this.store_id),this.isGift&&(e.order_type=1),t.accept_price&&(e.accept_price=t.accept_price),this.needLogin()&&!window._global.redirect_login_by_platform){var i=new u({contentViewClass:c,contentViewOptions:{afterLogin:_(function(n){var o=n.data||{};i.hide(),window.user_logined=!0,"pinjian"==window._global.goods_type?window.location.reload():(e.loginTicket=o.ticket,l.call(this,e,t))}).bind(this)}});return void i.render().show()}l.call(this,e,t)}}}(),doWait:function(t){t>0?(this.nConfirmBtn.attr("disabled",!0),this.isMultiBtn?this.nConfirmBtn.text(this.nConfirmBtn.data("text")+"("+t+")"):this.nConfirmBtn.text("正在排队购买，请等待 "+t+" 秒后再提交"),this.waitId=setTimeout(_(this.doWait).bind(this,t-1),1e3)):(this.nConfirmBtn.removeAttr("disabled"),this.nConfirmBtn.text(this.nConfirmBtn.data("text")),this.waitId=!1)},submitSuccess:function(t,e){var i=this,n=t.code;if(0===n){if(i.onAddSuccess({wish:i.isAddWish,cart:!1,buy:!i.isAddWish},e),i.isAddWish)return window.eventHandler&&window.eventHandler.trigger("wish:add"),window.eventHandler&&window.eventHandler.trigger("global_icon:new"),void i.doHideSkuView();g(t.data.trade_confirm_url)}else 13021===n?g(t.data.redirectUrl):(motify.log(t.msg),i.nConfirmBtn.html("再次提交"),i.nConfirmBtn.removeAttr("disabled"))},submitError:function(t,e,i,n){this.doDisabled(this.nConfirmBtn,!1),"buy"==t?this.nConfirmBtn.html("立即购买"):"add-cart"==t?motify.log("添加到购物车失败[errorType: "+i+"]"):"add-wish"==t&&(motify.log("添加到心愿单失败[errorType: "+i+"]"),this.nConfirmBtn.html("下一步")),window.StackTraceLogger&&window.StackTraceLogger.paasLog({appName:"jserror-wap",logIndex:"trade",name:"goodsBuyFailed",message:JSON.stringify({buyType:t,status:e.status,responseURL:e.responseURL,reponseText:(e.responseText||"").slice(0,1e3),errorType:i,errorThrown:n}),level:"info"})},doHideSkuView:function(){this.onHide()},onCancelClicked:function(t){this.doHideSkuView()},hide:function(t){this.waitId&&(clearTimeout(this.waitId),this.waitId=!1,this.nConfirmBtn.removeAttr("disabled")),this.isMultiBtn&&(this.$(".js-sku-views").empty(),this.$(".layout-content").height("auto"),this.skuSelectorView=this.skuSelectorView.clear())},height:function(){var t=$(window).height()-this.viewTop,e=this.$(".sku-layout-title").outerHeight(),i=this.$(".content-foot").outerHeight(),n=t-e-i,o=this.$(".js-sku-views").height();this.skuConH=o,this.skuConWinH=n,this.skuConHeight=n>o?o:n,this.skuViewHeight=this.skuConHeight+e,this.$(".js-sku-views").css("max-height",n)},onAfterPopupShow:function(){this.quantityView&&this.quantityView.validateNum()},displaySku:function(t){return this.render(t||{})},getLimitNum:function(t,e,i){var n,o,s=t-e;if(s<0&&(s=0),this.isHotel){var r=this.hotelConfig.bookDays;s=Math.floor(s/r)}return this.isVirtual&&(s=Math.min(t-e,100)),i>s&&0!==t?(n=+s,o="quota"):(n=+i,o="stock"),{limitNum:n,limitType:o}},doDisabled:function(t,e){e?t.attr("disabled",!0):t.removeAttr("disabled")},isDisabled:function(t){return t.attr("disabled")},getBuyType:function(){return this.isAddWish?"add-wish":this.isAddCart?"add-cart":this.isGift?"gift":"buy"},needLogin:function(){return!(window.user_logined||!this.need_ajax_login)&&(!this.isAddWish&&!this.isAddCart)}});return window.BuyView=C}),define("main",function(){}),function(t){var e=document,i="appendChild",n="styleSheet",o=e.createElement("style");o.type="text/css",e.getElementsByTagName("head")[0][i](o),o[n]?o[n].cssText=t:o[i](e.createTextNode(t))
}('@charset "UTF-8";.block,.block-item{display:block;overflow:hidden;border-image:url(https://b.yzcdn.cn/v2/image/wap/border-line-2.png) 2 stretch}.quantity,.quantity .txt,.quantity button,.sku-layout .vertical-middle{vertical-align:middle}.block,.block p,.block-item{overflow:hidden}.block,.block-item,.sku-layout .block-item,.sku-layout-title,.sku-message dl{border-image:url(https://b.yzcdn.cn/v2/image/wap/border-line-2.png) 2 stretch}.image-input-trigger,.quantity .txt{-webkit-tap-highlight-color:transparent}.block-item{position:relative;padding:10px;line-height:1.5;border:0;-webkit-border-image:url(https://b.yzcdn.cn/v2/image/wap/border-line-2.png) 2 stretch;-moz-border-image:url(https://b.yzcdn.cn/v2/image/wap/border-line-2.png) 2 stretch;border-top:2px solid #e5e5e5}@media only screen and (-webkit-min-device-pixel-ratio:1.5),only screen and (min--moz-device-pixel-ratio:1.5),only screen and (min-device-pixel-ratio:1.5){.block-item{border-top-width:1px}}.block-item .btn-auth-code{position:absolute;top:6px;right:0;height:30px;line-height:30px;padding-left:7px;padding-right:7px;font-weight:700}.block-item .verify-image{position:absolute;width:80px;height:30px;right:10px;top:7px}.block,.quantity,.quantity .minus{position:relative}.block-item.border-none{border-top:0}.block-item ul{padding-right:50px}.block-item ul em{color:#999}.block-item h4.block-item-title{line-height:22px;float:left;margin-right:10px}.block{-webkit-border-image:url(https://b.yzcdn.cn/v2/image/wap/border-line-2.png) 2 stretch;-moz-border-image:url(https://b.yzcdn.cn/v2/image/wap/border-line-2.png) 2 stretch;border-top:2px solid #e5e5e5;border-bottom:2px solid #e5e5e5;margin:10px 0;background-color:#fff;font-size:14px}.block.top-0,.block:first-child{margin-top:0}.quantity,.tag{display:inline-block}@media only screen and (-webkit-min-device-pixel-ratio:1.5),only screen and (min--moz-device-pixel-ratio:1.5),only screen and (min-device-pixel-ratio:1.5){.block{border-top-width:1px;border-bottom-width:1px}}.block.border-0,.block.border-top-0{border-top:0}.block.border-0,.block.border-bottom-0{border-bottom:0}.block.bottom-0{margin-bottom:0}.block .bottom{padding:10px;height:18px;line-height:18px}.block .bottom .price{float:right;color:#f60}.block.block-list{margin:0;padding:0 0 0 10px;list-style:none;font-size:14px;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}.block.block-list.margin-top-normal{margin-top:20px}.block-list.wf{padding-left:0}.block-list.wf .b-list{padding-left:10px;background-color:#fff}.block-list>.block-item{padding:10px 10px 10px 0}.block-list>.block-item:first-child{border-top:0 none}.block.block-list+.block.block-list{margin-top:12px}.quantity .txt,.quantity button,.tag{margin:0;text-align:center}@media only screen and (-webkit-min-device-pixel-ratio:1.5),only screen and (min--moz-device-pixel-ratio:1.5),only screen and (-o-min-device-pixel-ratio:3 / 2),only screen and (min-device-pixel-ratio:1.5){.block.block-list li span.clear{background:url(https://b.yzcdn.cn/v2/image/wap/icon_clear@2x.png) center center no-repeat;background-size:100%}}.tag{background-color:transparent;border:1px solid #e5e5e5;border-radius:3px;color:#999;font-size:12px;line-height:12px;padding:4px}.tag-big{font-size:14px;line-height:18px}.tag.tag-green{color:#06bf04;border-color:#0c3}.tag.tag-orange,.tag.tag-orangef60{color:#f60;border-color:#f60}.tag.tag-white{color:#333;border-color:#bbb}.tag.tag-blue{color:#38f;border-color:#38f}.tag.tag-red{color:#ed5050;border-color:#ed5050}.tag.tag-pink{color:#ee614b;border-color:#ee614b}.tag.disabled{background-color:#ddd!important;background-image:none!important;border:1px solid transparent!important;color:#fff!important}.quantity{font-size:0}.quantity input[type=number]::-webkit-outer-spin-button{margin:0}.quantity button{border:2px solid #eee;font-size:16px;line-height:10px;font-weight:700;color:#666;padding:5px;outline:0!important;width:26px;height:30px;text-indent:-9999px;overflow:hidden}.quantity .txt{font-size:14px;width:24px;height:18px;border-radius:0}.quantity .minus::before,.quantity .plus::before{width:8px;height:2px;top:0;left:0;right:0;margin:auto;background-color:#6c6c6c;bottom:0;content:\'\'}.quantity .txt:focus{border-color:#eee}.quantity .minus{border-radius:4px 0 0 4px;border-right:0 none}.quantity .minus::before{position:absolute}.quantity .plus{position:relative;border-left:0 none;border-radius:0 4px 4px 0}.quantity .plus::before{position:absolute}.quantity .plus::after{position:absolute;top:0;bottom:0;left:0;right:0;margin:auto;content:\'\';width:2px;height:8px;background-color:#6c6c6c}.quantity .minus.disabled::before,.quantity .plus.disabled::after,.quantity .plus.disabled::before{background-color:#ddd}.quantity .response-area{width:42px;height:42px;top:-7px;position:absolute}.name-card,.name-card .thumb{position:relative;overflow:hidden}.quantity .response-area-plus{right:-5px}.quantity .response-area-minus{left:-5px}.name-card{margin-left:0;width:auto;padding:5px 0}.name-card .thumb{width:60px;height:60px;float:left;margin-left:auto;margin-right:auto;background-size:cover}.name-card .thumb img{position:absolute;margin:auto;top:0;left:0;right:0;bottom:0;width:auto;height:auto;max-width:100%;max-height:100%}.name-card a:active,.name-card a:hover{text-decoration:none}.name-card .detail{margin-left:68px;width:auto;position:relative}.name-card .detail h3{margin-top:1px;color:#333;font-size:12px;line-height:16px;width:100%}.name-card .detail p{position:relative;font-size:12px;line-height:16px;white-space:nowrap;margin:0 0 2px;color:#ccc}.name-card .detail a{display:block}.name-card .detail .l2-ellipsis{max-height:34px;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}.name-card .btn-goods-link{bottom:8px;right:10px;position:absolute;line-height:14px;font-size:12px}.name-card.name-card-3col{padding:8px 85px 8px 0}.name-card.name-card-3col .right-col{position:absolute;right:0;top:8px;width:78px;padding-right:10px;font-size:12px}.name-card.name-card-3col .right-col .price{font-size:14px;color:#515151;text-align:right;line-height:16px}.name-card.name-card-3col .right-col .num{font-weight:200;text-align:right;margin-top:3px;padding:0;color:#555}.name-card.name-card-3col .right-col .num .num-txt{padding:0;line-height:22px;color:#515151}.name-card.name-card-3col .right-col .order-state{font-size:13px;text-align:right}.sku-layout{background-color:#f8f8f8}.sku-layout .line-through{display:inline-block;text-decoration:line-through;line-height:23px}.sku-layout .block-item{border:0;-webkit-border-image:url(https://b.yzcdn.cn/v2/image/wap/border-line-2.png) 2 stretch;-moz-border-image:url(https://b.yzcdn.cn/v2/image/wap/border-line-2.png) 2 stretch;border-top:2px solid #e5e5e5}@media only screen and (-webkit-min-device-pixel-ratio:1.5),only screen and (min--moz-device-pixel-ratio:1.5),only screen and (min-device-pixel-ratio:1.5){.sku-layout .block-item{border-top-width:1px}}.sku-layout .block-item:first-child{border-top:0 none}.sku-box-shadow{-webkit-box-shadow:0 -1px 14px rgba(0,0,0,.9);box-shadow:0 -1px 14px rgba(0,0,0,.9)}.sku-layout-title{-webkit-border-image:url(https://b.yzcdn.cn/v2/image/wap/border-line-2.png) 2 stretch;-moz-border-image:url(https://b.yzcdn.cn/v2/image/wap/border-line-2.png) 2 stretch;border-bottom:2px solid #e5e5e5;border-top-width:0;position:static;padding:10px 0;margin-left:10px}@media only screen and (-webkit-min-device-pixel-ratio:1.5),only screen and (min--moz-device-pixel-ratio:1.5),only screen and (min-device-pixel-ratio:1.5){.sku-layout-title{border-bottom-width:1px}}.sku-layout-title .thumb{width:50px;height:50px;border:1px solid #eee;border-radius:2px}.sku-layout-title .goods-base-info{margin-left:60px}.sku-layout-title .goods-base-info .title{padding-right:52px;margin-bottom:5px;font-size:14px;line-height:22px}.sku-layout-title .goods-base-info .goods-price{padding:0 55px 0 0}.sku-layout-title .goods-base-info .current-price{line-height:20px}.sku-layout-title .goods-base-info .current-price .price-name{padding-top:1px}.sku-layout-title .goods-base-info .current-price .price-tag{padding:0 5px;margin-left:5px;line-height:16px;font-size:10px;border-radius:2px}.sku-layout-title .goods-base-info .old-price,.sku-layout-title .goods-base-info .original-price{color:#999}.sku-layout-title .goods-base-info .original-price{display:none}.sku-layout-title .goods-base-info .old-price{display:block;margin:5px 0 0 2px;font-size:10px;line-height:12px}.sku-layout .sku-cancel{position:absolute;right:0;top:0;padding:10px}.sku-layout .sku-cancel .cancel-img{height:22px;width:22px;background-image:url(https://b.yzcdn.cn/v2/image/wap/sku/icon_close.png);background-size:22px 22px}.sku-layout .goods-models .sku-list-container{padding:10px 0 0;border:0}.sku-layout .sku-sel-title{margin-bottom:10px;font-size:13px}.sku-layout .sku-sel-list{zoom:1;padding-left:0;margin-bottom:0}.sku-layout .sku-sel-list:after{content:\'\';display:table;clear:both}.sku-layout .sku-tag{position:relative;margin-right:10px;min-width:32px;line-height:16px;padding:5px 9px;margin-bottom:10px;color:#333;border-color:#999}.sku-layout .sku-tag.unavailable{border-color:#e5e5e5;color:#cacaca;background-color:#eee;cursor:not-allowed}.sku-layout .sku-tag.active{color:#fff;background-color:#f60;border-color:#f60}.sku-layout .sku-num{line-height:29px}.sku-layout .other-info{line-height:14px}.sku-layout .stock{display:inline-block;margin-right:10px;font-size:12px}.sku-layout .quota{display:inline-block;font-size:12px;color:#f15a0c}.sku-layout .quantity{float:right}.sku-layout .quantity .minus{border-radius:2px 0 0 2px}.sku-layout .quantity .minus.disabled{background-color:#f8f8f8;border-color:#e8e8e8 #999 #e8e8e8 #e8e8e8}.sku-layout .quantity .minus.disabled::before{background-color:#bbb}.sku-layout .quantity .plus{border-radius:0 2px 2px 0}.sku-layout .quantity .plus.disabled{background-color:#f8f8f8;border-color:#e8e8e8 #e8e8e8 #e8e8e8 #999}.sku-layout .quantity .plus.disabled::after,.sku-layout .quantity .plus.disabled::before{background-color:#bbb}.sku-layout .quantity .txt{width:33px;height:25px;padding:1px;border:1px solid #999;border-width:1px 0;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;color:#666}.sku-layout .quantity .txtCover{position:absolute;top:0;left:37px;bottom:0;right:37px}.sku-layout .quantity .minus,.sku-layout .quantity .plus{width:37px;height:29px;background-color:#fff;border:1px solid #999}.sku-layout .quantity .minus::before,.sku-layout .quantity .plus::before{height:1px;width:9px;background-color:#666}.sku-layout .quantity .minus::after,.sku-layout .quantity .plus::after{width:1px;height:9px;background-color:#666}sup.required{color:red!important}.block-list .block-item.block-item-messages{padding:0;overflow:visible;-webkit-tap-highlight-color:transparent}.sku-message dl{-webkit-border-image:url(https://b.yzcdn.cn/v2/image/wap/border-line-2.png) 2 stretch;-moz-border-image:url(https://b.yzcdn.cn/v2/image/wap/border-line-2.png) 2 stretch;border-top:2px solid #e5e5e5}@media only screen and (-webkit-min-device-pixel-ratio:1.5),only screen and (min--moz-device-pixel-ratio:1.5),only screen and (min-device-pixel-ratio:1.5){.sku-message dl{border-top-width:1px}}.sku-message dl:first-child{border:0}.sku-message dt{width:70px;position:relative}.sku-message dt .required{position:absolute;left:-7px;font-size:14px}.sku-message dt label{display:inline-block;line-height:44px}.sku-message dt .multi-label{padding-bottom:0}.sku-message .comment-wrapper{margin-left:90px;padding-right:5px;position:relative}.sku-message .comment-wrapper .txt,.sku-message .comment-wrapper .txta{padding:12px 0;line-height:20px;width:97%;border:0;outline:0;-webkit-appearance:none;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}.sku-message .comment-wrapper .txta{-webkit-transition:height .3s ease-in-out;-moz-transition:height .3s ease-in-out;transition:height .3s ease-in-out;line-height:20px;padding:0;margin-top:12px;height:20px;margin-bottom:6px;resize:none}.sku-message .comment-wrapper .focus-texta{height:52px}.cancel-input{background:url(https://b.yzcdn.cn/v2/image/wap/sku/icon_close.png) center no-repeat;height:44px;width:44px;background-size:16px 16px;position:absolute;right:0;top:0;display:none}.goods-models.js-sku-views.block.block-list{margin-bottom:10px}.image-input-trigger{padding:0 10px;height:24px;line-height:24px;margin:15px 0}.image-input-trigger .select-photo::before,.image-input-trigger .take-photo::before{content:\'\';position:relative;display:inline-block;margin-right:5px;width:14px;height:12px;background-size:14px 12px}.image-input-trigger .take-photo{margin-right:10px}.image-input-trigger .take-photo::before{top:1px;background-image:url(https://b.yzcdn.cn/v2/image/wap/sku/icon_camera.png)}.image-input-trigger .select-photo::before{top:2px;margin-left:10px;background-image:url(https://b.yzcdn.cn/v2/image/wap/sku/icon_img.png)}.img-tip{display:block;margin-top:-10px;font-size:12px;color:#999}.image-input-show{margin-bottom:8px;height:60px}.image-input-show img{margin-right:5px;width:60px;height:60px;vertical-align:text-bottom}.photo-input{position:absolute;opacity:0;height:40px;width:175px;left:0;top:0}.sku-layout{-webkit-overflow-scrolling:touch}.sku-layout .layout-content{overflow-y:scroll;line-height:20px;background-color:#f8f8f8}.sku-layout .content-foot{font-size:0}.sku-layout .content-foot .half-button{float:left;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;width:50%}.sku-layout .content-foot .half-button:first-child{padding-right:5px}.sku-layout .content-foot .half-button:last-child{padding-left:5px}.sku-layout .content-foot .btn-buy,.sku-layout .content-foot .btn-cart,.sku-layout .content-foot .btn-next{padding:8px;line-height:17px;font-size:14px}@font-face{font-family:iconfont;src:url(https://b.yzcdn.cn/youzan-icon/font/iconfont-0.1.eot?t=1481088669367);src:url(https://b.yzcdn.cn/youzan-icon/font/iconfont-0.1.eot?t=1481088669367#iefix) format("embedded-opentype"),url(https://b.yzcdn.cn/youzan-icon/font/iconfont-0.1.woff?t=1481088669367) format("woff"),url(https://b.yzcdn.cn/youzan-icon/font/iconfont-0.1.ttf?t=1481088669367) format("truetype"),url(https://b.yzcdn.cn/youzan-icon/font/iconfont-0.1.svg?t=1481088669367#iconfont) format("svg")}.iconfont{font-family:iconfont!important;font-size:16px;font-style:normal;-webkit-font-smoothing:antialiased;-webkit-text-stroke-width:.2px;-moz-osx-font-smoothing:grayscale}.new-btn,.new-btn .desc{font-size:10px;text-align:center}.icon-certificate:before{content:"\\e602"}.icon-search:before{content:"\\e603"}.icon-gift:before{content:"\\e604"}.icon-cancel:before{content:"\\e605"}.icon-left-arrow:before{content:"\\e606"}.icon-shopping-cart:before{content:"\\e607"}.icon-location:before{content:"\\e608"}.icon-service:before{content:"\\e609"}.icon-store:before{content:"\\e60a"}.orange-btn::after,.red-btn::after{content:"";-webkit-box-sizing:border-box;-moz-box-sizing:border-box;top:0;left:0;-webkit-transform:scale(.5)}.orange-btn{background:#f85;color:#fff;position:relative}.orange-btn::after{position:absolute;box-sizing:border-box;width:200%;height:200%;-moz-transform:scale(.5);-ms-transform:scale(.5);transform:scale(.5);-webkit-transform-origin:left top;-moz-transform-origin:left top;-ms-transform-origin:left top;transform-origin:left top;pointer-events:none;border-top:1px solid #E57A4C}.disabled-btn::after,.red-btn::after{width:200%;height:200%;-moz-transform:scale(.5);-ms-transform:scale(.5);pointer-events:none}.orange-btn:active{background:#DD6F44}.red-btn{background-color:#f44;color:#fff;position:relative}.red-btn::after{position:absolute;box-sizing:border-box;transform:scale(.5);-webkit-transform-origin:left top;-moz-transform-origin:left top;-ms-transform-origin:left top;transform-origin:left top;border-top:1px solid #E53D3D}.buy-cart::after,.disabled-btn::after{content:"";-webkit-box-sizing:border-box;-moz-box-sizing:border-box;top:0;left:0;-webkit-transform:scale(.5)}.red-btn:active{background:#D43333}.disabled-btn{background:#e5e5e5;color:#999;position:relative}.disabled-btn::after{position:absolute;box-sizing:border-box;transform:scale(.5);-webkit-transform-origin:left top;-moz-transform-origin:left top;-ms-transform-origin:left top;transform-origin:left top;border-top:1px solid #cdcdcd}.warning-bar{margin:0;height:35px;line-height:35px;background:#FFF7CC!important}.big-btn,.new-btn{height:50px;float:left}.new-btn{line-height:50px;background-color:#fff}.new-btn:active{background-color:#F8F8F8}.new-btn .desc{position:absolute;line-height:normal;left:0;bottom:5px;width:100%;color:#666}.new-btn .van-icon{font-size:20px;color:#666}.big-btn{line-height:50px;font-size:16px;padding:0;border:none;vertical-align:top}.big-btn-1-1{overflow:hidden;text-align:center}.big-btn-1-1 .big-btn{width:100%}.big-btn-2-1{font-size:0;overflow:hidden;text-align:center}.big-btn-2-1 .big-btn{width:50%}.buy-cart{position:relative}.buy-cart::after{position:absolute;box-sizing:border-box;width:200%;height:200%;-moz-transform:scale(.5);-ms-transform:scale(.5);transform:scale(.5);-webkit-transform-origin:left top;-moz-transform-origin:left top;-ms-transform-origin:left top;transform-origin:left top;pointer-events:none;border-top:1px solid rgba(0,0,0,.1);border-right:1px solid rgba(0,0,0,.1)}.gift::after,.service::after{content:"";-webkit-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-transform:scale(.5);-moz-transform:scale(.5);-ms-transform:scale(.5);pointer-events:none;border-top:1px solid rgba(0,0,0,.1);border-right:1px solid rgba(0,0,0,.1)}.buy-cart .icon-shopping-cart{display:block;width:20px;height:20px;line-height:20px;font-size:18px;position:absolute;top:8px;left:50%;margin-left:-10px;color:#666}.buy-cart-msg::before{content:"";height:8px;width:8px;border-radius:8px;background:#f44;position:absolute;top:7px;left:50%;margin-left:7px;z-index:2}.service{position:relative}.service::after{position:absolute;top:0;left:0;box-sizing:border-box;width:200%;height:200%;transform:scale(.5);-webkit-transform-origin:left top;-moz-transform-origin:left top;-ms-transform-origin:left top;transform-origin:left top}.service .icon-service{display:block;height:20px;width:20px;line-height:20px;font-size:20px;color:#f44;position:absolute;top:8px;left:50%;margin-left:-10px}.service-msg::before{content:"";height:8px;width:8px;border-radius:8px;background:#f44;position:absolute;top:7px;left:50%;margin-left:7px;z-index:2}.gift{position:relative}.gift::after{position:absolute;top:0;left:0;box-sizing:border-box;width:200%;height:200%;transform:scale(.5);-webkit-transform-origin:left top;-moz-transform-origin:left top;-ms-transform-origin:left top;transform-origin:left top}.new-btn.point::after,.new-btn.promotion::after{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-transform:scale(.5);-moz-transform:scale(.5);-ms-transform:scale(.5)}.gift .icon-gift{display:block;width:20px;height:20px;font-size:18px;line-height:20px;position:absolute;top:8px;left:50%;margin-left:-10px;color:#666}.new-btn.point::after,.new-btn.promotion::after,.new-btn.shop::after{content:"";top:0;left:0;width:200%;height:200%;pointer-events:none;border-top:1px solid rgba(0,0,0,.1);border-right:1px solid rgba(0,0,0,.1)}.new-btn.point{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAoCAMAAACo9wirAAAAY1BMVEUAAABpaWloaGhmZmZmZmZnZ2dycnJnZ2dnZ2dmZmZmZmZnZ2dtbW1ra2toaGhmZmZmZmZlZWVmZmZmZmZnZ2dmZmZpaWlmZmZoaGhmZmZmZmZmZmZmZmZnZ2dkZGRmZmZmZmYJ5zNiAAAAIHRSTlMAGVzpy8YH+sDv4NoVEQ705Luok4ptKF9MsX94VUgzS+0p87kAAAD3SURBVDjL7ZRJrsMgEEQZDBgDnqfMdf9T/v6xpYTEFllmkbcAS1UGuqUu9jlc9I2TxkjX9IK/qnpQiFCDftYHCVSH0zx6rf04nw4VIIfH4TmgztEf+qyAnK+6Qz2zN+YabnFkyALbIJDwvwsUJdukLCBoy2ndQSCnVYLvtgYyaUhekXzkWibfvICE5aOA6d/13qDgi6EGUHUhalJXAajvBq2gWhCyOV7Gshwvx0aCaEnQZJjgAvOtRYRtPQsOExnUWua1y6wBYWzWXZ/KtPBsBw/76+R2Jw1gvrWTu6OXHN70+McBclsC5LYGSDqCYvj0CLGJs4/5AxbWIm2lZulWAAAAAElFTkSuQmCC);background-size:18px;background-repeat:no-repeat;background-position:50% 7px;position:relative}.new-btn.point::after{position:absolute;box-sizing:border-box;transform:scale(.5);-webkit-transform-origin:left top;-moz-transform-origin:left top;-ms-transform-origin:left top;transform-origin:left top}.new-btn.promotion{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAMAAABiM0N1AAAAY1BMVEUAAAD/RET/RET/RET/RUX/RUX/RET/Rkb/Rkb/R0f/UFD/VVX/WVn/RUX/RUX/RUX/RET/RUX/RUX/RET/RUX/RUX/RET/Rkb/RET/Rkb/Rkb/Rkb/R0f/R0f/RUX/RET/RET/klPVAAAAIHRSTlMAnffs3LSZPyIZEAkFZe7q48vIv6OUg4BwbVdQSEE0LcnOiicAAAG2SURBVFjD7dfJbsIwFEbha2eeGFvm4bz/UzZ0E1VQ/7d0hcTZREjRJ5I4jm3v3r1O1325zrNo3215kEepwvzn2dunoEN+f/b279B5ya1Y7E5129ujggOqC8Zm4djZrwU0VGVA3LRmaScIaIhA2Zh0LAn1n8DiYg4nDd2cVeNx0tAAfHQeJw1VcXTM46ShOoOV6/8IqICF6/4I6Ay4npeCllB6HAUdIHrGoYRy2DgcCVUwa7WjoQDB40xtH0NzODqdSXo0P0PsnM4k2X17KJTjqoSdcHyt4SQcXznUwvGVQSscXxF64TwHaaeHqC9NO9ZCpm+2dqyGXD9+7dgJ1npAasd2UOpXRDtWwF6/tNrpIlw908ggxs8R5uaa2ML0W5yvptoh5bQzqExO/rrN9yhSnyNdE+Fgpj6QuhKW40F8snUX4DwexSJC1iym4ZtY1si6FWS1jYmFluoD4vTon176daPDYCK9GG1WwKdy9PL4srg5vWDkgr0pgSiuS28h2k0EMnGf1aamO4YZY0XiuYttVt/Wp10RubVMjGe58ZvK795T/1Z0ah6qf26OY5avy/3V3r17mb4A97lDYil581IAAAAASUVORK5CYII=);background-size:24px;background-repeat:no-repeat;background-position:50% 5px;position:relative}.new-btn.promotion::after{position:absolute;box-sizing:border-box;transform:scale(.5);-webkit-transform-origin:left top;-moz-transform-origin:left top;-ms-transform-origin:left top;transform-origin:left top}.new-btn.shop{position:relative}.new-btn.shop::after{position:absolute;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;-webkit-transform:scale(.5);-moz-transform:scale(.5);-ms-transform:scale(.5);transform:scale(.5);-webkit-transform-origin:left top;-moz-transform-origin:left top;-ms-transform-origin:left top;transform-origin:left top}.big-mini-btn-1-1,.big-mini-btn-2-1,.mini-btn-1-1,.mini-btn-2-1,.mini-btn-3-1{font-size:0;padding:0}@media screen and (min-width:768px){.mini-btn-1-1{float:left;width:70px}.mini-btn-1-1 .new-btn{width:70px}.mini-btn-2-1{float:left;width:120px}.mini-btn-2-1 .new-btn{width:60px}.mini-btn-3-1{float:left;width:129px}.mini-btn-3-1 .new-btn{width:43px}.mini-btn-4-1{float:left;width:184px}.mini-btn-4-1 .new-btn{width:46px}.presale-btn{position:relative}.presale-btn .left-desc-btn{position:absolute;left:10px!important}.presale-btn .right-buy-btn{right:10px!important}}@media screen and (max-width:321px){.mini-btn-1-1{float:left;width:70px}.mini-btn-1-1 .new-btn{width:70px}.mini-btn-2-1{float:left;width:120px}.mini-btn-2-1 .new-btn{width:60px}.mini-btn-3-1{float:left;width:129px}.mini-btn-3-1 .new-btn{width:43px}.mini-btn-4-1{float:left;width:184px}.mini-btn-4-1 .new-btn{width:46px}.presale-btn{position:relative}.presale-btn .left-desc-btn{position:absolute;left:10px!important}.presale-btn .right-buy-btn{right:10px!important}}@media screen and (min-width:321px) and (max-width:413px){.mini-btn-1-1{float:left;width:70px}.mini-btn-1-1 .new-btn{width:70px}.mini-btn-2-1{float:left;width:140px}.mini-btn-2-1 .new-btn{width:70px}.mini-btn-3-1{float:left;width:144px}.mini-btn-3-1 .new-btn{width:48px}.mini-btn-4-1{float:left;width:224px}.mini-btn-4-1 .new-btn{width:56px}}@media screen and (min-width:413px) and (max-width:767px){.mini-btn-1-1{float:left;width:80px}.mini-btn-1-1 .new-btn{width:80px}.mini-btn-2-1{float:left;width:160px}.mini-btn-2-1 .new-btn{width:80px}.mini-btn-3-1{float:left;width:174px}.mini-btn-3-1 .new-btn{width:58px}.mini-btn-4-1{float:left;width:264px}.mini-btn-4-1 .new-btn{width:66px}}.sku-layout .content-foot{padding:0!important;width:100%!important}.sku-layout .layout-content{border:none!important}.bottom-fix{border-top:0;bottom:-1px}.presale-btn{position:relative}.presale-btn .left-desc-btn{font-size:10px;position:absolute;left:8%}.presale-btn .multi-line{height:30px;margin-top:10px;line-height:15px;text-align:left}.presale-btn .right-buy-btn{position:absolute;right:8%}.show-more-mini-btn{position:absolute;width:72px;bottom:60px;left:-36px;margin-left:50%}.show-more-mini-btn .more-btn-tooltip{padding:3px 5px 1px;background:#fff;border-radius:2px;-webkit-filter:drop-shadow(0 2px 1px rgba(0, 0, 0, .2));filter:drop-shadow(0 2px 1px rgba(0, 0, 0, .2))}.show-more-mini-btn .more-btn-tooltip::after{content:\'\';display:block;width:0;height:0;border-style:solid;border-color:#fff transparent transparent;border-width:5px 5px 0;position:absolute;left:50%;margin-left:-5px;bottom:-5px}.show-more-mini-btn .more-btn-item{padding-top:12px;height:12px;line-height:12px;padding-bottom:14px;border-bottom:1px solid #e5e5e5;font-size:12px;color:#333}.show-more-mini-btn .more-btn-item .van-icon{font-size:14px;color:#666;vertical-align:middle;position:relative;top:-1px}.show-more-mini-btn .more-btn-item:last-child{border-bottom:none}.show-more-wrap{position:relative}.show-more-wrap .van-icon-more-o{font-size:20px}.sku-layout .goods-models{overflow-y:scroll}.sku-layout .block.block-list{border-bottom-width:0}');